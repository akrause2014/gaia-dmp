#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2022, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#zrq-notes-time
#zrq-notes-indent
#zrq-notes-crypto
#zrq-notes-ansible
#zrq-notes-osformat
#zrq-notes-zeppelin
#

    Target:

        Set up a test deployment so that we can check that changes to the table
        schema in the gaiadmpsetup library work with the new mount of DR3.

        Tweak the version of gaiadmpsetup.
        re-deploy
        check the new schema is loaded

    Result:

        Success.
        Zeppelin has a clone of Nigel's GitHub fork installed as an editable Python module at /home/fedora/nh-gaiadmpsetup

        The worker nodes all have a clone of Zeppelin's version.

        In theory if we need to we should be able to edit the source at /home/fedora/nh-gaiadmpsetup on the Zeppelin node
        and then use git pull to update each of the worker nodes.


# -----------------------------------------------------
# Check which version of gaiadmpsetup we have installed.
#[root@ansibler]

    ssh zeppelin

        pip show gaiadmpsetup

    >   Name: gaiadmpsetup
    >   Version: 0.1.1
    >   Summary: A setup script for Gaia DMP
    >   Home-page: https://github.com/wfau/aglais
    >   Author: Stelios Voutsinas
    >   Author-email: stv@roe.ac.uk
    >   License: BSD
    >   Location: /usr/local/lib/python3.7/site-packages
    >   Requires:
    >   Required-by:


        ls -al /usr/local/lib/python3.7/site-packages/gaiadmpsetup

    >   total 256
    >   drwxr-xr-x.   3 root root   4096 Feb  9 13:56 .
    >   drwxr-xr-x. 135 root root  12288 Feb  9 13:59 ..
    >   -rw-r--r--.   1 root root     27 Feb  9 13:54 __init__.py
    >   drwxr-xr-x.   2 root root   4096 Feb  9 13:56 __pycache__
    >   -rw-r--r--.   1 root root   2383 Feb  9 13:54 gaiadmpsetup.py
    >   -rw-r--r--.   1 root root   9238 Feb  9 13:54 gaiadmpstore.py
    >   -rw-r--r--.   1 root root 181292 Feb  9 13:54 gaiadr3_pyspark_schema_structures.py
    >   -rw-r--r--.   1 root root  33068 Feb  9 13:54 gaiaedr3_pyspark_schema_structures.py


        sed -n '/^table_dict/,/^}/ {p}' /usr/local/lib/python3.7/site-packages/gaiadmpsetup/gaiadr3_pyspark_schema_structures.py

    >   table_dict = {
    >       ##'vari_time_series_statistics',
    >       ##'alerts_mixedin_sourceids',
    >       'astrophysical_parameters' :
    >           ([astrophysical_parameters_schema], release_folder + '/GDR3_ASTROPHYSICAL_PARAMETERS'),
    >       'astrophysical_parameters_supp' :
    >           ([astrophysical_parameters_supp_schema], release_folder + '/GDR3_ASTROPHYSICAL_PARAMETERS_SUPP'),
    >       #'epoch_photometry' :
    >       #    ([epoch_photometry_schema], release_folder + '/GDR3_EPOCH_PHOTOMETRY'),
    >       'gaia_source' :
    >           ([gaia_source_schema], release_folder + '/GDR3_GAIASOURCE'),
    >       ##'galaxy_candidates',
    >       ##'galaxy_catalogue_name',
    >       #'mcmc_samples_gsp_phot' :
    >       #    ([mcmc_samples_gsp_phot_schema[], release_folder + '/GDR3_MCMC_SAMPLES_GSP_PHOT'),
    >       #'mcmc_samples_msc' :
    >       #    ([mcmc_samples_msc_schema[], release_folder + '/GDR3_MCMC_SAMPLES_MSC'),
    >       ##'nss_acceleration_astro',
    >       ##'nss_non_linear_spectro',
    >       ##'nss_two_body_orbit',
    >       ##'nss_vim_fl',
    >       #'oa_neuron_information' :
    >       #    ([oa_neuron_information_schema], release_folder + '/GDR3_OA_NEURON_INFORMATION'),
    >       #'oa_neuron_xp_spectra' :
    >       #    ([oa_neuron_xp_spectra_schema], release_folder + '/GDR3_OA_NEURON_XP_SPECTRA'),
    >       ##'qso_candidates',
    >       ##'qso_catalogue_name',
    >       'rvs_mean_spectrum' :
    >           ([rvs_mean_spectrum_schema], release_folder + '/GDR3_RVS_MEAN_SPECTRUM'),
    >       ##'science_alerts',
    >       ##'sso_observation',
    >       ##'sso_reflectance_spectrum',
    >       ##'sso_source',
    >       #'total_galactic_extinction_map' :
    >       #    ([total_galactic_extinction_map_schema], release_folder + '/GDR3_TOTAL_GALACTIC_EXTINCTION_MAP'),
    >       #'total_galactic_extinction_map_opt' :
    >       #    ([total_galactic_extinction_map_opt_schema], release_folder + '/GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT'),
    >       ##'vari_agn',
    >       ##'vari_classifier_class_definition',
    >       ##'vari_classifier_definition',
    >       ##'vari_classifier_result',
    >       ##'vari_compact_companion',
    >       ##'vari_eclipsing_binary',
    >       ##'vari_epoch_radial_velocity',
    >       ##'vari_long_period_variable',
    >       ##'vari_microlensing',
    >       ##'vari_ms_oscillator',
    >       ##'vari_planetary_transit',
    >       ##'vari_rad_vel_statistics',
    >       ##'vari_short_timescale',
    >       'xp_continuous_mean_spectrum' :
    >           ([xp_continuous_mean_spectrum_schema], release_folder + '/GDR3_XP_CONTINUOUS_MEAN_SPECTRUM'),
    >       'xp_sampled_mean_spectrum' :
    >           ([xp_sampled_mean_spectrum_schema], release_folder + '/GDR3_XP_SAMPLED_MEAN_SPECTRUM'),
    >       'xp_summary' :
    >           ([xp_summary_schema], release_folder + '/GDR3_XP_SUMMARY'),
    >       ##'commanded_scan_law',
    >       ##'agn_cross_id',
    >       ##'frame_rotator_source',
    >       ##'gaia_crf3_xm',
    >       ##'gaia_source_simulation' :
    >       ##    ([gaia_source_simulation_schema], release_folder + '/GDR3_GAIA_SOURCE_SIMULATION'),
    >       ##'gaia_universe_model' :
    >       ##    ([gaia_universe_model_schema], release_folder + '/GDR3_UNIVERSE_MODEL'),
    >       'gaia_source_tmasspsc_best_neighbours' :
    >           ([tmasspscxsc_best_neighbour_schema, twomass_psc_schema], release_folder + '/GDR3_2MASSPSC_BEST_NEIGHBOURS'),
    >       'gaia_source_allwise_best_neighbours' :
    >           ([allwise_best_neighbour_schema, allwise_sc_schema], release_folder + '/GDR3_ALLWISE_BEST_NEIGHBOURS'),
    >       'gaia_source_ps1_best_neighbours' :
    >           ([panstarrs1_best_neighbour_schema, panstarrs_dr1_otmo_schema], release_folder + '/GDR3_PS1_BEST_NEIGHBOURS')
    >   }



# -----------------------------------------------------
# Change the version of gaiadmpsetup.
#[root@ansibler]

    ssh zeppelin

        pip show gaiadmpsetup

    >   Name: gaiadmpsetup
    >   Version: 0.1.1
    >   Summary: A setup script for Gaia DMP
    >   Home-page: https://github.com/wfau/aglais
    >   Author: Stelios Voutsinas
    >   Author-email: stv@roe.ac.uk
    >   License: BSD
    >   Location: /usr/local/lib/python3.7/site-packages
    >   Requires:
    >   Required-by:


        git clone 'https://github.com/NigelHambly/gaiadmpsetup' '/home/fedora/nh-gaiadmpsetup'

        sudo pip install --editable '/home/fedora/nh-gaiadmpsetup'

        pip show gaiadmpsetup

    >   Cloning into '/home/fedora/nh-gaiadmpsetup'...
    >   remote: Enumerating objects: 117, done.
    >   remote: Counting objects: 100% (28/28), done.
    >   remote: Compressing objects: 100% (21/21), done.
    >   remote: Total 117 (delta 9), reused 9 (delta 7), pack-reused 89
    >   Receiving objects: 100% (117/117), 69.35 KiB | 2.89 MiB/s, done.
    >   Resolving deltas: 100% (67/67), done.

    >   WARNING: Running pip install with root privileges is generally not a good idea. Try `pip install --user` instead.
    >   Obtaining file:///home/fedora/nh-gaiadmpsetup
    >   Installing collected packages: gaiadmpsetup
    >     Found existing installation: gaiadmpsetup 0.1.1
    >       Uninstalling gaiadmpsetup-0.1.1:
    >         Successfully uninstalled gaiadmpsetup-0.1.1
    >     Running setup.py develop for gaiadmpsetup
    >   Successfully installed gaiadmpsetup

    >   Name: gaiadmpsetup
    >   Version: 0.1.1
    >   Summary: A setup script for Gaia DMP
    >   Home-page: https://github.com/wfau/aglais
    >   Author: Stelios Voutsinas
    >   Author-email: stv@roe.ac.uk
    >   License: BSD
    >   Location: /home/fedora/nh-gaiadmpsetup
    >   Requires:
    >   Required-by:


        sed -n '/^table_dict/,/^}/ {p}' '/home/fedora/nh-gaiadmpsetup/gaiadmpsetup/gaiadr3_pyspark_schema_structures.py'

    >   table_dict = {
    >       ##'vari_time_series_statistics', now incorporated in vari_summary, so exclude (C9DM-541)
    >       'alerts_mixedin_sourceids' :
    >           ([alerts_mixedin_sourceids_schema], release_folder + '/GDR3_ALERTS_MIXEDIN_SOURCEIDS', 'alert_source_id'),
    >       'astrophysical_parameters' :
    >           ([astrophysical_parameters_schema], release_folder + '/GDR3_ASTROPHYSICAL_PARAMETERS', 'source_id'),
    >       'astrophysical_parameters_supp' :
    >           ([astrophysical_parameters_supp_schema], release_folder + '/GDR3_ASTROPHYSICAL_PARAMETERS_SUPP', 'source_id'),
    >       'epoch_photometry' :
    >           ([epoch_photometry_schema], release_folder + '/GDR3_EPOCH_PHOTOMETRY', 'source_id'),
    >       'gaia_source' :
    >           ([gaia_source_schema], release_folder + '/GDR3_GAIASOURCE', 'source_id'),
    >       'galaxy_candidates' :
    >           ([galaxy_candidates_schema], release_folder + '/GDR3_GALAXY_CANDIDATES', 'source_id'),
    >       'galaxy_catalogue_name' :
    >           ([galaxy_catalogue_name_schema], release_folder + '/GDR3_GALAXY_CATALOGUE_NAME', 'source_id'),
    >       'mcmc_samples_gsp_phot' :
    >           ([mcmc_samples_gsp_phot_schema], release_folder + '/GDR3_MCMC_SAMPLES_GSP_PHOT', 'source_id'),
    >       'mcmc_samples_msc' :
    >           ([mcmc_samples_msc_schema], release_folder + '/GDR3_MCMC_SAMPLES_MSC', 'source_id'),
    >       'nss_acceleration_astro' :
    >           ([nss_acceleration_astro_schema], release_folder + '/GDR3_NSS_ACCELERATION_ASTRO', 'source_id'),
    >       'nss_non_linear_spectro' :
    >           ([nss_non_linear_spectro_schema], release_folder + '/GDR3_NSS_NON_LINEAR_SPECTRO', 'source_id'),
    >       'nss_two_body_orbit' :
    >           ([nss_two_body_orbit_schema], release_folder + '/GDR3_NSS_TWO_BODY_ORBIT', 'source_id'),
    >       'nss_vim_fl' :
    >           ([nss_vim_fl_schema], release_folder + '/GDR3_NSS_VIM_FL', 'source_id'),
    >       'oa_neuron_information' :
    >           ([oa_neuron_information_schema], release_folder + '/GDR3_OA_NEURON_INFORMATION', 'som_id'),
    >       'oa_neuron_xp_spectra' :
    >           ([oa_neuron_xp_spectra_schema], release_folder + '/GDR3_OA_NEURON_XP_SPECTRA', 'neuron_id'),
    >       'qso_candidates' :
    >           ([qso_candidates_schema], release_folder + '/GDR3_QSO_CANDIDATES', 'source_id'),
    >       'qso_catalogue_name' :
    >           ([qso_catalogue_name_schema], release_folder + '/GDR3_QSO_CATALOGUE_NAME', 'source_id'),
    >       'rvs_mean_spectrum' :
    >           ([rvs_mean_spectrum_schema], release_folder + '/GDR3_RVS_MEAN_SPECTRUM', 'source_id'),
    >       'science_alerts' :
    >           ([science_alerts_schema], release_folder + '/GDR3_SCIENCE_ALERTS', 'source_id'),
    >       'sso_observation' :
    >           ([sso_observation_schema], release_folder + '/GDR3_SSO_OBSERVATION', 'source_id'),
    >       'sso_reflectance_spectrum' :
    >           ([sso_reflectance_spectrum_schema], release_folder + '/GDR3_SSO_REFLECTANCE_SPECTRUM', 'source_id'),
    >       'sso_source' :
    >           ([sso_source_schema], release_folder + '/GDR3_SSO_SOURCE', 'source_id'),
    >       'total_galactic_extinction_map' :
    >           ([total_galactic_extinction_map_schema], release_folder + '/GDR3_TOTAL_GALACTIC_EXTINCTION_MAP', 'healpix_id'),
    >       'total_galactic_extinction_map_opt' :
    >           ([total_galactic_extinction_map_opt_schema], release_folder + '/GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT', 'healpix_id'),
    >       'vari_agn' :
    >           ([vari_agn_schema], release_folder + '/GDR3_VARI_AGN', 'source_id'),
    >       'vari_cepheid' :
    >           ([vari_cepheid_schema], release_folder + '/GDR3_VARI_CEPHEID', 'source_id'),
    >       'vari_classifier_class_definition' :
    >           ([vari_classifier_class_definition_schema], release_folder + '/GDR3_VARI_CLASSIFIER_CLASS_DEFINITION', 'classifier_name'),
    >       'vari_classifier_definition' :
    >           ([vari_classifier_definition_schema], release_folder + '/GDR3_VARI_CLASSIFIER_DEFINITION', 'classifier_name'),
    >       'vari_classifier_result' :
    >           ([vari_classifier_result_schema], release_folder + '/GDR3_VARI_CLASSIFIER_RESULT', 'source_id'),
    >       'vari_compact_companion' :
    >           ([vari_compact_companion_schema], release_folder + '/GDR3_VARI_COMPACT_COMPANION', 'source_id'),
    >       'vari_eclipsing_binary' :
    >           ([vari_eclipsing_binary_schema], release_folder + '/GDR3_VARI_ECLIPSING_BINARY', 'source_id'),
    >       'vari_epoch_radial_velocity' :
    >           ([vari_epoch_radial_velocity_schema], release_folder + '/GDR3_VARI_EPOCH_RADIAL_VELOCITY', 'transit_id'),
    >       'vari_long_period_variable' :
    >           ([vari_long_period_variable_schema], release_folder + '/GDR3_VARI_LONG_PERIOD_VARIABLE', 'source_id'),
    >       'vari_microlensing' :
    >           ([vari_microlensing_schema], release_folder + '/GDR3_VARI_MICROLENSING', 'source_id'),
    >       'vari_ms_oscillator' :
    >           ([vari_ms_oscillator_schema], release_folder + '/GDR3_VARI_MS_OSCILLATOR', 'source_id'),
    >       'vari_planetary_transit' :
    >           ([vari_planetary_transit_schema], release_folder + '/GDR3_VARI_PLANETARY_TRANSIT', 'source_id'),
    >       'vari_rad_vel_statistics' :
    >           ([vari_rad_vel_statistics_schema], release_folder + '/GDR3_VARI_RAD_VEL_STATISTICS', 'source_id'),
    >       'vari_rotation_modulation' :
    >           ([vari_rotation_modulation_schema], release_folder + '/GDR3_VARI_ROTATION_MODULATION', 'source_id'),
    >       'vari_rrlyrae' :
    >           ([vari_rrlyrae_schema], release_folder + '/GDR3_VARI_RRLYRAE', 'source_id'),
    >       'vari_short_timescale' :
    >           ([vari_short_timescale_schema], release_folder + '/GDR3_VARI_SHORT_TIMESCALE', 'source_id'),
    >       'vari_summary' :
    >           ([vari_summary_schema], release_folder + '/GDR3_VARI_SUMMARY', 'source_id'),
    >       'xp_continuous_mean_spectrum' :
    >           ([xp_continuous_mean_spectrum_schema], release_folder + '/GDR3_XP_CONTINUOUS_MEAN_SPECTRUM', 'source_id'),
    >       'xp_sampled_mean_spectrum' :
    >           ([xp_sampled_mean_spectrum_schema], release_folder + '/GDR3_XP_SAMPLED_MEAN_SPECTRUM', 'source_id'),
    >       'xp_summary' :
    >           ([xp_summary_schema], release_folder + '/GDR3_XP_SUMMARY', 'source_id'),
    >       ##'commanded_scan_law', These should be put in the EDR3 schema if required, so leave out here.
    >       ##'agn_cross_id',
    >       ##'frame_rotator_source',
    >       ##'gaia_crf3_xm',
    >       ##'gaia_source_simulation',
    >       ##'gaia_universe_model',
    >       'gaia_source_tmasspsc_best_neighbours' :
    >           ([tmasspscxsc_best_neighbour_schema, twomass_psc_schema], release_folder + '/GDR3_2MASSPSC_BEST_NEIGHBOURS', 'source_id'),
    >       'gaia_source_allwise_best_neighbours' :
    >           ([allwise_best_neighbour_schema, allwise_sc_schema], release_folder + '/GDR3_ALLWISE_BEST_NEIGHBOURS', 'source_id'),
    >       'gaia_source_ps1_best_neighbours' :
    >           ([panstarrs1_best_neighbour_schema, panstarrs_dr1_otmo_schema], release_folder + '/GDR3_PS1_BEST_NEIGHBOURS', 'source_id')
    >   }

    #
    # Update all the workers using this clone.
    for nodenum in {01..06}
    do
        nodename="worker${nodenum}"
        echo
        ssh -A "${nodename}" \
            '
            date
            hostname
            echo
            pip install --user --upgrade git+ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup
            '
    done

    >   Fri Feb 10 05:17:41 UTC 2023
    >   iris-gaia-blue-20230209-worker01
    >
    >   Collecting git+ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup
    >     Cloning ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup to /tmp/pip-req-build-jb3auubb
    >     Running command git clone -q ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup /tmp/pip-req-build-jb3auubb
    >   Installing collected packages: gaiadmpsetup
    >     Running setup.py install for gaiadmpsetup: started
    >       Running setup.py install for gaiadmpsetup: finished with status 'done'
    >   Successfully installed gaiadmpsetup-0.1.1

    >   ....
    >   ....

    >   Fri Feb 10 05:17:50 UTC 2023
    >   iris-gaia-blue-20230209-worker06
    >
    >   Collecting git+ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup
    >     Cloning ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup to /tmp/pip-req-build-24dyvk2v
    >     Running command git clone -q ssh://fedora@zeppelin/home/fedora/nh-gaiadmpsetup /tmp/pip-req-build-24dyvk2v
    >   Installing collected packages: gaiadmpsetup
    >     Running setup.py install for gaiadmpsetup: started
    >       Running setup.py install for gaiadmpsetup: finished with status 'done'
    >   Successfully installed gaiadmpsetup-0.1.1


    #
    # Check the version on one of the workers.
    ssh worker03 \
        '
        date
        hostname
        echo
        pip show gaiadmpsetup
        '

    >   Fri Feb 10 05:26:22 UTC 2023
    >   iris-gaia-blue-20230209-worker03
    >
    >   Name: gaiadmpsetup
    >   Version: 0.1.1
    >   Summary: A setup script for Gaia DMP
    >   Home-page: https://github.com/wfau/aglais
    >   Author: Stelios Voutsinas
    >   Author-email: stv@roe.ac.uk
    >   License: BSD
    >   Location: /home/fedora/.local/lib/python3.7/site-packages
    >   Requires:
    >   Required-by:


    #
    # Check the schema on one of the workers.
    ssh worker03 \
        '
        date
        hostname
        echo
        sed -n "/^table_dict/,/^}/ {p}" "/home/fedora/.local/lib/python3.7/site-packages/gaiadmpsetup/gaiadr3_pyspark_schema_structures.py"
        '

    >   Fri Feb 10 05:28:38 UTC 2023
    >   iris-gaia-blue-20230209-worker03
    >
    >   table_dict = {
    >       ##'vari_time_series_statistics', now incorporated in vari_summary, so exclude (C9DM-541)
    >       'alerts_mixedin_sourceids' :
    >           ([alerts_mixedin_sourceids_schema], release_folder + '/GDR3_ALERTS_MIXEDIN_SOURCEIDS', 'alert_source_id'),
    >       'astrophysical_parameters' :
    >           ([astrophysical_parameters_schema], release_folder + '/GDR3_ASTROPHYSICAL_PARAMETERS', 'source_id'),
    >       'astrophysical_parameters_supp' :
    >           ([astrophysical_parameters_supp_schema], release_folder + '/GDR3_ASTROPHYSICAL_PARAMETERS_SUPP', 'source_id'),
    >       'epoch_photometry' :
    >           ([epoch_photometry_schema], release_folder + '/GDR3_EPOCH_PHOTOMETRY', 'source_id'),
    >   ....
    >   ....


# -----------------------------------------------------
# Try loading the library.
#[root@ansibler]

    ssh zeppelin

        cat > /tmp/friday.py << 'EOF'
import gaiadmpsetup
EOF

        python /tmp/friday.py

    >   Traceback (most recent call last):
    >     File "/tmp/friday.py", line 1, in <module>
    >       import gaiadmpsetup
    >     File "/home/fedora/nh-gaiadmpsetup/gaiadmpsetup/__init__.py", line 1, in <module>
    >       from . import gaiadmpsetup
    >     File "/home/fedora/nh-gaiadmpsetup/gaiadmpsetup/gaiadmpsetup.py", line 1, in <module>
    >       from pyspark.sql.types import *
    >     File "/opt/spark/python/pyspark/__init__.py", line 53, in <module>
    >       from pyspark.rdd import RDD, RDDBarrier
    >     File "/opt/spark/python/pyspark/rdd.py", line 34, in <module>
    >       from pyspark.java_gateway import local_connect_and_auth
    >     File "/opt/spark/python/pyspark/java_gateway.py", line 29, in <module>
    >       from py4j.java_gateway import java_import, JavaGateway, JavaObject, GatewayParameters
    >   ModuleNotFoundError: No module named 'py4j'


    #
    # Looks like gaiadmpsetup has to be loaded from inside a Spark/Zeppelin environment.
    #


        cat > /tmp/friday.py << 'EOF'
from gaiadmpsetup import gaiadr3_pyspark_schema_structures as dr3
EOF

        python /tmp/friday.py

    >   Traceback (most recent call last):
    >     File "/tmp/friday.py", line 1, in <module>
    >       from gaiadmpsetup import gaiadr3_pyspark_schema_structures as dr3
    >     File "/home/fedora/nh-gaiadmpsetup/gaiadmpsetup/__init__.py", line 1, in <module>
    >       from . import gaiadmpsetup
    >     File "/home/fedora/nh-gaiadmpsetup/gaiadmpsetup/gaiadmpsetup.py", line 1, in <module>
    >       from pyspark.sql.types import *
    >     File "/opt/spark/python/pyspark/__init__.py", line 53, in <module>
    >       from pyspark.rdd import RDD, RDDBarrier
    >     File "/opt/spark/python/pyspark/rdd.py", line 34, in <module>
    >       from pyspark.java_gateway import local_connect_and_auth
    >     File "/opt/spark/python/pyspark/java_gateway.py", line 29, in <module>
    >       from py4j.java_gateway import java_import, JavaGateway, JavaObject, GatewayParameters
    >   ModuleNotFoundError: No module named 'py4j'


# -----------------------------------------------------
# Setup a local SSH tunnel SOCKS proxy.
# https://unix.stackexchange.com/questions/34004/how-does-tcp-keepalive-work-in-ssh
# https://unix.stackexchange.com/a/34201
#[root@ansibler]

    ssh \
        -n \
        -f \
        -N \
        -D '*:3000' \
        -o ServerAliveInterval=10 \
        -o ServerAliveCountMax=12 \
        zeppelin

    >   ....
    >   ....


# -----------------------------------------------------
# Login via the SOCKS proxy and test.
#[user@desktop]

    firefox --new-window "http://zeppelin:8080/"



# -----------------------------------------------------
# -----------------------------------------------------

    %pyspark
    import gaiadmpsetup

    # show the contents of the catalogue store that has been set up
    for line in spark.catalog.listTables(): print (line)

    >   Table(name='astrophysical_parameters', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='astrophysical_parameters_supp', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source_allwise_best_neighbours', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source_ps1_best_neighbours', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source_tmasspsc_best_neighbours', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='rvs_mean_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='xp_continuous_mean_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='xp_sampled_mean_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='xp_summary', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='classified_sources', database=None, description=None, tableType='TEMPORARY', isTemporary=True)
    >   Table(name='raw_sources', database=None, description=None, tableType='TEMPORARY', isTemporary=True)

    #
    # This is the OLD table list :-(
    #

# -----------------------------------------------------
# -----------------------------------------------------

    %sh
    pip show gaiadmpsetup


    >   Name: gaiadmpsetup
    >   Version: 0.1.1
    >   Summary: A setup script for Gaia DMP
    >   Home-page: https://github.com/wfau/aglais
    >   Author: Stelios Voutsinas
    >   Author-email: stv@roe.ac.uk
    >   License: BSD
    >   Location: /home/fedora/nh-gaiadmpsetup
    >   Requires:
    >   Required-by:

    #
    # So pip claims to be using the new version of the library.
    #


# -----------------------------------------------------
# -----------------------------------------------------

    %pyspark
    import gaiadmpsetup
    import inspect

    inspect.getmembers(gaiadmpsetup)

    >   ....
    >   ....
    >   ('__cached__', '/usr/local/lib/python3.7/site-packages/gaiadmpsetup/__pycache__/__init__.cpython-37.pyc'),
    >   ('__doc__', None),
    >   ('__file__', '/usr/local/lib/python3.7/site-packages/gaiadmpsetup/__init__.py'),
    >   ('__loader__', <_frozen_importlib_external.SourceFileLoader object at 0x7fafcce51650>),
    >   ('__name__', 'gaiadmpsetup'),
    >   ('__package__', 'gaiadmpsetup'),
    >   ('__path__', ['/usr/local/lib/python3.7/site-packages/gaiadmpsetup']),
    >   ('__spec__', None),
    >   ('gaiadmpsetup', <module 'gaiadmpsetup.gaiadmpsetup' from '/usr/local/lib/python3.7/site-packages/gaiadmpsetup/gaiadmpsetup.py'>),
    >   ('gaiadmpstore', <module 'gaiadmpsetup.gaiadmpstore' from '/usr/local/lib/python3.7/site-packages/gaiadmpsetup/gaiadmpstore.py'>),
    >   ('gaiadr3_pyspark_schema_structures', <module 'gaiadmpsetup.gaiadr3_pyspark_schema_structures' from '/usr/local/lib/python3.7/site-packages/gaiadmpsetup/gaiadr3_pyspark_schema_structures.py'>),
    >   ('gaiaedr3_pyspark_schema_structures', <module 'gaiadmpsetup.gaiaedr3_pyspark_schema_structures' from '/usr/local/lib/python3.7/site-packages/gaiadmpsetup/gaiaedr3_pyspark_schema_structures.py'>)]

    #
    # .. but pyspark is using the OLD version.
    #


# -----------------------------------------------------
# -----------------------------------------------------

    restart our interpreter

# -----------------------------------------------------
# -----------------------------------------------------

    %pyspark
    import gaiadmpsetup

    # show the contents of the catalogue store that has been set up
    for line in spark.catalog.listTables(): print (line)

    >   Table(name='alerts_mixedin_sourceids', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='astrophysical_parameters', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='astrophysical_parameters_supp', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='epoch_photometry', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source_allwise_best_neighbours', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source_ps1_best_neighbours', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='gaia_source_tmasspsc_best_neighbours', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='galaxy_candidates', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='galaxy_catalogue_name', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='mcmc_samples_gsp_phot', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='mcmc_samples_msc', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='nss_acceleration_astro', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='nss_non_linear_spectro', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='nss_two_body_orbit', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='nss_vim_fl', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='oa_neuron_information', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='oa_neuron_xp_spectra', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='qso_candidates', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='qso_catalogue_name', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='rvs_mean_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='science_alerts', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='sso_observation', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='sso_reflectance_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='sso_source', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='total_galactic_extinction_map', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='total_galactic_extinction_map_opt', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_agn', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_cepheid', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_classifier_class_definition', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_classifier_definition', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_classifier_result', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_compact_companion', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_eclipsing_binary', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_epoch_radial_velocity', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_long_period_variable', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_microlensing', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_ms_oscillator', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_planetary_transit', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_rad_vel_statistics', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_rotation_modulation', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_rrlyrae', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_short_timescale', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='vari_summary', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='xp_continuous_mean_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='xp_sampled_mean_spectrum', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)
    >   Table(name='xp_summary', database='gaiadr3', description=None, tableType='EXTERNAL', isTemporary=False)

    #
    # Yay - we get the NEW verson :-)
    #

# -----------------------------------------------------
# -----------------------------------------------------

# define a data frame object on a table:
df = spark.sql(
    "select * from gaiadr3.epoch_photometry"
    )

# display the schema with a touch of friendly formatting:
print("Column details of gaiadr3.epoch_photometry:\n")
for field in df.schema:
  print(
    "%32s : %-10s"%(
        field.name, field.dataType.simpleString()
        )
    )

    >   Column details of gaiadr3.epoch_photometry:
    >
    >                        solution_id : bigint
    >                          source_id : bigint
    >                         n_transits : smallint
    >                         transit_id : array<bigint>
    >                     g_transit_time : array<double>
    >                     g_transit_flux : array<double>
    >               g_transit_flux_error : array<double>
    >          g_transit_flux_over_error : array<float>
    >                      g_transit_mag : array<double>
    >                    g_transit_n_obs : array<tinyint>
    >                        bp_obs_time : array<double>
    >                            bp_flux : array<double>
    >                      bp_flux_error : array<double>
    >                 bp_flux_over_error : array<float>
    >                             bp_mag : array<double>
    >                        rp_obs_time : array<double>
    >                            rp_flux : array<double>
    >                      rp_flux_error : array<double>
    >                 rp_flux_over_error : array<float>
    >                             rp_mag : array<double>
    >         photometry_flag_noisy_data : array<boolean>
    >     photometry_flag_sm_unavailable : array<boolean>
    >    photometry_flag_af1_unavailable : array<boolean>
    >    photometry_flag_af2_unavailable : array<boolean>
    >    photometry_flag_af3_unavailable : array<boolean>
    >    photometry_flag_af4_unavailable : array<boolean>
    >    photometry_flag_af5_unavailable : array<boolean>
    >    photometry_flag_af6_unavailable : array<boolean>
    >    photometry_flag_af7_unavailable : array<boolean>
    >    photometry_flag_af8_unavailable : array<boolean>
    >    photometry_flag_af9_unavailable : array<boolean>
    >     photometry_flag_bp_unavailable : array<boolean>
    >     photometry_flag_rp_unavailable : array<boolean>
    >          photometry_flag_sm_reject : array<boolean>
    >         photometry_flag_af1_reject : array<boolean>
    >         photometry_flag_af2_reject : array<boolean>
    >         photometry_flag_af3_reject : array<boolean>
    >         photometry_flag_af4_reject : array<boolean>
    >         photometry_flag_af5_reject : array<boolean>
    >         photometry_flag_af6_reject : array<boolean>
    >         photometry_flag_af7_reject : array<boolean>
    >         photometry_flag_af8_reject : array<boolean>
    >         photometry_flag_af9_reject : array<boolean>
    >          photometry_flag_bp_reject : array<boolean>
    >          photometry_flag_rp_reject : array<boolean>
    >          variability_flag_g_reject : array<boolean>
    >         variability_flag_bp_reject : array<boolean>
    >         variability_flag_rp_reject : array<boolean>


# -----------------------------------------------------
# -----------------------------------------------------

    %pyspark
    df.show()

    >   +------------------+------------------+----------+--------------------+--------------------+--------------------+--------------------+-------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------------+------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+------------------------------+------------------------------+-------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+-------------------------+-------------------------+-------------------------+--------------------------+--------------------------+
    >   |       solution_id|         source_id|n_transits|          transit_id|      g_transit_time|      g_transit_flux|g_transit_flux_error|g_transit_flux_over_error|       g_transit_mag|     g_transit_n_obs|         bp_obs_time|             bp_flux|       bp_flux_error|  bp_flux_over_error|              bp_mag|         rp_obs_time|             rp_flux|       rp_flux_error|  rp_flux_over_error|              rp_mag|photometry_flag_noisy_data|photometry_flag_sm_unavailable|photometry_flag_af1_unavailable|photometry_flag_af2_unavailable|photometry_flag_af3_unavailable|photometry_flag_af4_unavailable|photometry_flag_af5_unavailable|photometry_flag_af6_unavailable|photometry_flag_af7_unavailable|photometry_flag_af8_unavailable|photometry_flag_af9_unavailable|photometry_flag_bp_unavailable|photometry_flag_rp_unavailable|photometry_flag_sm_reject|photometry_flag_af1_reject|photometry_flag_af2_reject|photometry_flag_af3_reject|photometry_flag_af4_reject|photometry_flag_af5_reject|photometry_flag_af6_reject|photometry_flag_af7_reject|photometry_flag_af8_reject|photometry_flag_af9_reject|photometry_flag_bp_reject|photometry_flag_rp_reject|variability_flag_g_reject|variability_flag_bp_reject|variability_flag_rp_reject|
    >   +------------------+------------------+----------+--------------------+--------------------+--------------------+--------------------+-------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------------+------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+------------------------------+------------------------------+-------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+-------------------------+-------------------------+-------------------------+--------------------------+--------------------------+
    >   |375316653866487564|  3929315256010368|        25|[2355277661721525...|[1822.78727035054...|[7933.34419890842...|[13.5376886573460...|     [586.0191, 644.54...|[15.9387261241789...|[8, 9, 9, 0, 9, 8...|[1822.78761310785...|[3112.19161691588...|[32.0910618485069...|[96.98001, 100.11...|[16.6058763944190...|[1822.78770058101...|[6972.71304594877...|[42.6396475524298...|[163.52652, 162.2...|[15.1393910194578...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [true, false, fal...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 29202341639591296|        24|[1718816057673475...|[1707.68537381240...|[190.923052837082...|[4.33033360985282...|     [44.089687, 25.76...|[19.9852209418874...|[8, 9, 9, 9, 8, 9...|[1707.68571664553...|[1577.50042806976...|[35.1029420008661...|[44.939266, 9.651...|[17.3436185013821...|[1707.68580406671...|[182.845087314699...|[17.4553875427149...|[10.474995, 6.388...|[19.0926872606586...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [true, false, fal...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [true, false, fal...|     [false, false, fa...|     [false, false, fa...|      [true, false, fal...|      [false, false, fa...|
    >   |375316653866487564| 38256068276473984|        35|[1733603856707242...|[1710.35893614492...|[1247.44384312855...|[13.2968899459259...|     [93.814705, 159.4...|[17.9473143574058...|[9, 9, 9, 9, 9, 9...|[1710.35925068184...|[634.942587343646...|[30.1669023398894...|[21.047657, 31.52...|[18.3317060723592...|[1710.35933901407...|[937.801016695465...|[28.2049322320971...|[33.24954, 41.155...|[17.3176187530709...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, true, tru...|      [false, true, tru...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, tr...|     [false, true, tru...|      [false, false, fa...|      [false, false, tr...|
    >   |375316653866487564| 47970592808967296|        39|[1918157467525660...|[1743.73654446763...|[108.927554732635...|[5.11062861986756...|     [21.313925, 21.72...|[20.5945224809211...|[9, 8, 8, 9, 9, 9...|[1743.73683794605...|[254.026941467007...|[26.4918701732969...|[9.588864, 3.6218...|[19.3263427676534...|[1743.73692608745...|[60.5017940313270...|[23.7320675281244...|[2.5493689, 4.363...|[20.2934748692195...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, tr...|           [false, false, fa...|           [false, true, fal...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [true, false, fal...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, tr...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 62135571047166336|        35|[1720163072335897...|[1707.92835179691...|[26006.1049695466...|[23.6287028054322...|     [1100.615, 369.75...|[14.6496785891134...|[8, 9, 9, 9, 8, 9...|[1707.92869454122...|[10332.0093099729...|[60.3531282140491...|[171.19261, 206.5...|[15.3030802437080...|[1707.92878240055...|[22388.1491969107...|[76.6149553950875...|[292.21643, 309.2...|[13.8728500200869...|      [false, true, tru...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [true, false, fal...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|     [false, false, fa...|     [false, false, fa...|     [false, true, tru...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 63358331055255424|        31|[1728051410897421...|[1709.35466172400...|[2786.92514370383...|[20.0718090549148...|     [138.84773, 25.98...|[17.0745536075552...|[9, 8, 8, 9, 9, 9...|[1709.35497616612...|[1308.09274703444...|[28.9909318514335...|[45.120754, 56.72...|[17.5469458716959...|[1709.35506492121...|[2279.35697794273...|[31.6447824926569...|[72.02947, 84.783...|[16.3533646340024...|      [false, true, tru...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, true, tru...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, true, tru...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, true, tru...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 68717896188306432|        28|[1835558513965479...|[1728.79864139253...|[163.589190955891...|[8.15650327924250...|     [20.05629, 28.780...|[20.1529803556258...|[8, 9, 8, 9, 9, 9...|[1728.79898413303...|[53.152379117735,...|[16.6013167198594...|[3.2016966, 5.861...|[21.0247354446566...|[1728.79907200493...|[117.054258624694...|[16.9738765112795...|[6.8961415, 7.377...|[19.5769274545018...|      [false, true, fal...|          [true, false, fal...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [true, false, tru...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [true, false, fal...|      [true, false, fal...|      [true, false, fal...|      [true, false, fal...|      [true, false, fal...|      [true, false, fal...|      [true, false, fal...|      [true, false, fal...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [true, false, fal...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 73203220730178432|        24|[1699476213889611...|[1704.18873786900...|[51494.6296586307...|[73.0708256678242...|     [704.72217, 246.6...|[13.9079620192698...|[8, 5, 9, 9, 9, 8...|[1704.18908071216...|[14696.8108206244...|[69.8801648322037...|[210.31448, NaN, ...|[14.9204844560136...|[1704.18916805794...|[55617.0183755324...|[120.583534108073...|[461.23227, NaN, ...|[12.8848762445161...|      [false, true, fal...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, true, fal...|           [false, true, fal...|           [false, true, fal...|           [true, true, fals...|          [false, true, fal...|          [false, true, fal...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, true, fal...|      [false, true, fal...|      [false, true, fal...|      [false, true, fal...|     [false, true, fal...|     [false, true, fal...|     [false, false, fa...|      [false, true, fal...|      [false, true, fal...|
    >   |375316653866487564| 74355130959081728|        23|[1707356620483533...|[1705.61357830175...|[280.103161243421...|[4.60757458888548...|     [60.79189, 38.377...|[19.5690718413120...|[9, 9, 9, 8, 9, 8...|[1705.61389313589...|[304.003732945389...|[29.5420616954813...|[10.290539, 813.5...|[19.1313449246404...|[1705.61397985172...|[130291.098166645...|[300.278439931095...|[433.90094, 11.08...|[11.9606086397160...|      [false, false, tr...|          [false, false, tr...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, tr...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, true, fal...|     [true, false, fal...|     [false, false, fa...|      [false, true, fal...|      [true, false, fal...|
    >   |375316653866487564| 77158400278391680|        25|[1699056763523981...|[1704.11278737726...|[306.750923711309...|[8.40506700227755...|     [36.495953, 56.22...|[19.4704021691030...|[8, 9, 9, 8, 9, 8...|[1704.11313016731...|[92.5132926305424...|[27.4729476208200...|[3.3674324, 10.36...|[20.4230318704001...|[1704.11321780877...|[73.5434836729273...|[27.3368091968743...|[2.690273, 16.238...|[20.0815350059893...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [true, false, fal...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [true, false, fal...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 78345842771704448|        26|[1694902962632305...|[1703.36166852486...|[259.441071545197...|[3.98644298460959...|     [65.08084, 43.934...|[19.6522700435693...|[9, 9, 8, 9, 9, 9...|[1703.36198339675...|[179.243663097417...|[28.6616766847191...|[6.2537746, 1.406...|[19.7049326889153...|[1703.36206989022...|[187.662945127823...|[27.8830579267326...|[6.730357, 10.339...|[19.0644491818175...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, tr...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, true, fal...|      [false, false, fa...|
    >   |375316653866487564| 80556440963848832|        23|[1700424668783187...|[1704.35999132273...|[296.879409046746...|[8.73331337685382...|     [33.993904, 37.38...|[19.5059166749136...|[9, 9, 7, 9, 9, 9...|[1704.36028482815...|[178.528716216762...|[39.5735557583123...|[4.5113134, 6.601...|[19.7092720107353...|[1704.36037280656...|[280.371012667630...|[27.7923605443999...|[10.08806, 12.085...|[18.6285627255041...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, tr...|           [false, false, tr...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [true, false, tru...|      [false, false, tr...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, false, fa...|      [false, false, tr...|
    >   |375316653866487564| 81663924050698752|        15|[3398188547667744...|[2011.38586954283...|[89.6172927594920...|[4.42559479109650...|     [20.249773, 11.46...|[20.8063873165222...|[9, 9, 9, 8, 8, 9...|[2011.38618454504...|[74.1128725014198...|[17.1857644703011...|[4.312457, 6.0876...|[20.6638081003427...|[2011.38627032566...|[86.7060134886959...|[27.5059449798311...|[3.1522646, 5.990...|[19.9027724537042...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564| 94536422073390720|        24|[1693495524158271...|[1703.10688986559...|[192.091356705468...|[5.16961127618404...|     [37.157795, 19.45...|[19.9785973073163...|[9, 9, 8, 9, 9, 9...|[1703.10720461068...|[149.461103476196...|[37.8390070086468...|[3.9499214, 753.1...|[19.9022217549417...|[1703.10729183619...|[310.389464422741...|[30.2892890879058...|[10.247499, 4.586...|[18.5181280723046...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, tr...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, tr...|          [false, false, tr...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, tr...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, true, tru...|     [false, false, tr...|     [false, false, fa...|      [false, true, tru...|      [false, false, tr...|
    >   |375316653866487564| 97148075722340864|        23|[1689350189744963...|[1702.35739022534...|[163698.043946263...|[113.422604491534...|     [1443.2577, 1494....|[12.6522581420813...|[9, 9, 9, 9, 9, 9...|[1702.35770510091...|[89778.6378103010...|[168.494609478091...|[532.82794, 538.3...|[12.9556096866229...|[1702.35779157484...|[105396.192141884...|[165.738795162660...|[635.9175, 660.78...|[12.1908331998086...|      [false, false, tr...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, fa...|     [false, false, fa...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564|103213183724679680|        19|[1702182082122192...|[1704.67722020165...|[1980.83344075344...|[9.66887526139775...|     [204.867, 100.284...|[17.4452469689749...|[9, 9, 9, 9, 9, 9...|[1704.67753497633...|[757.218678340697...|[24.4753625347042...|[30.937996, 45.70...|[18.1404889203432...|[1704.67762204950...|[1640.00411129604...|[25.9719039869177...|[63.145317, 76.41...|[16.7107831592199...|      [false, true, tru...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, true, fal...|     [false, false, fa...|      [false, false, fa...|      [false, false, fa...|
    >   |375316653866487564|103425458188339328|        21|[1699416696400752...|[1704.17721994974...|[326.230593910596...|[7.68030595431413...|     [42.47625, 32.853...|[19.4035551501607...|[9, 9, 9, 8, 9, 9...|[NaN, 1825.553597...|[NaN, 236.1502144...|[NaN, 16.78666811...|[NaN, 14.067724, ...|[NaN, 19.40557135...|[NaN, 1825.553686...|[NaN, 223.8753351...|[NaN, 16.18122414...|[NaN, 13.835501, ...|[NaN, 18.87287987...|      [false, true, fal...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [true, false, fal...|     [true, false, tru...|     [false, false, fa...|      [true, false, fal...|      [true, false, fal...|
    >   |375316653866487564|103518263841726848|        17|[2483928685543853...|[1846.05083797939...|[128.325833412367...|[5.19230890745755...|     [24.7146, 31.4040...|[20.4165816333848...|[9, 9, 9, 9, 9, 9...|[1846.05115292273...|[31.8039140259567...|[21.0839094778998...|[1.5084448, 5.388...|[21.5823407888494...|[1846.05123856818...|[17.1583338341031...|[25.7574468337438...|[0.6661504, 8.945...|[21.6617077180411...|      [false, false, fa...|          [false, true, tru...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, fa...|     [false, false, tr...|     [false, false, fa...|      [false, false, fa...|      [false, false, tr...|
    >   |375316653866487564|107986167995817600|        23|[1696231061062509...|[1703.60107126301...|[47452.9956484485...|[48.8242205075082...|     [971.91504, 655.0...|[13.9967077818108...|[9, 9, 9, 9, 9, 9...|[1703.60138616564...|[18010.8066122510...|[75.5589462642206...|[238.36763, 243.1...|[14.6997093080676...|[1703.60147248297...|[42059.9182456152...|[106.396755695245...|[395.31204, 417.0...|[13.1882244406873...|      [false, true, fal...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, true, fal...|     [false, false, fa...|     [false, false, fa...|      [false, true, fal...|      [false, false, fa...|
    >   |375316653866487564|113459498223697536|        20|[2376495957901038...|[1826.62441830971...|[148.814076193611...|[5.97240293854263...|     [24.916952, 79.58...|[20.2557568353333...|[9, 9, 9, 9, 8, 9...|[1826.62473257627...|[41.0301788301640...|[15.4469057666939...|[2.656207, 2.4190...|[21.3057836911851...|[1826.62482177186...|[75.2274737977469...|[15.7500209100052...|[4.7763414, 3.644...|[20.0569543059353...|      [false, false, fa...|          [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|           [false, false, fa...|          [false, false, fa...|          [false, false, fa...|     [true, true, true...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|      [false, false, fa...|     [false, false, tr...|     [false, false, fa...|     [false, false, fa...|      [false, false, tr...|      [false, false, fa...|
    >   +------------------+------------------+----------+--------------------+--------------------+--------------------+--------------------+-------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------------+------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+------------------------------+------------------------------+-------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+--------------------------+-------------------------+-------------------------+-------------------------+--------------------------+--------------------------+
    >   only showing top 20 rows




