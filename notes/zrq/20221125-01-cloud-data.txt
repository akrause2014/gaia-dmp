#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2022, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#zrq-notes-time
#zrq-notes-indent
#zrq-notes-crypto
#zrq-notes-ansible
#zrq-notes-osformat
#zrq-notes-zeppelin
#

    Target:

        Success

    Result:

        Work in progress ...


# -----------------------------------------------------
# Install the S3 client.
#[user@zeppelin]

    sudo dnf install s3cmd

    >   Installed:
    >       s3cmd-2.0.2-3.fc30.noarch


# -----------------------------------------------------
# Install the secrets function.
#[user@zeppelin]

    datahostname='data.gaia-dmp.uk'
    datahostuser='fedora'

    getsecret()
        {
        local key=${1:?'key required'}
        ssh -n "${datahostuser:?}@${datahostname:?}" \
            "
            getsecret '${key:?}'
            "
        }

    getsecret 'examples.frog'
    getsecret 'examples.toad'

    >   Green Frog

    >   Brown Toad


# -----------------------------------------------------
# Configure our S3 client.
# https://linux.die.net/man/1/s3cmd
# https://s3tools.org/kb/item14.htm
# https://www.digitalocean.com/docs/spaces/resources/s3cmd/
# https://support.arcticcloud.com/portal/kb/articles/managing-object-storage-using-the-s3cmd-interface
# https://docs.ceph.com/en/latest/radosgw/s3/commons/#bucket-and-host-name
#[user@zeppelin]

    s3cmd \
        --configure \
        --host $(getsecret devops.stfc.echo.endpoint) \
        --host-bucket $(getsecret devops.stfc.echo.template) \
        --access_key $(getsecret  devops.stfc.echo.access_key) \
        --secret_key $(getsecret  devops.stfc.echo.secret_key)

    >   New settings:
    >     Access Key: ##########
    >     Secret Key: ##########
    >     Default Region: US
    >     S3 Endpoint: s3.echo.stfc.ac.uk
    >     DNS-style bucket+hostname:port template for accessing a bucket: s3.echo.stfc.ac.uk/%(bucket)
    >     Encryption password:
    >     Path to GPG program: /usr/bin/gpg
    >     Use HTTPS protocol: True
    >     HTTP Proxy server name:
    >     HTTP Proxy server port: 0

    >   Test access with supplied credentials? [Y/n]
    >   Please wait, attempting to list all buckets...
    >   Success. Your access key and secret key worked fine :-)
    >
    >   Now verifying that encryption works...
    >   Not configured. Never mind.
    >
    >   Save settings? [y/N] y
    >   Configuration saved to '/home/fedora/.s3cfg'


# -----------------------------------------------------
# List our buckets.
#[user@zeppelin]

    s3cmd \
        ls

    >   2021-12-24 00:26  s3://aglais-data-gaia-dr2-6514
    >   2021-12-24 09:24  s3://aglais-data-gaia-edr3-11932
    >   2021-12-24 15:28  s3://aglais-data-gaia-edr3-2048
    >   2021-12-24 15:28  s3://aglais-data-gaia-edr3-4096
    >   2021-12-24 00:38  s3://aglais-user-nch
    >   2021-12-23 18:27  s3://aglais-user-zrq
    >   2021-02-28 02:44  s3://gaia-edr3


# -----------------------------------------------------
# List the contents of a bucket.
#[user@zeppelin]

    s3cmd \
        ls  's3://aglais-data-gaia-dr2-6514'

    >   DIR  s3://aglais-data-gaia-dr2-6514/GDR2_6514/


    s3cmd \
        ls 's3://aglais-data-gaia-dr2-6514/GDR2_6514/'


    >   DIR  s3://aglais-data-gaia-dr2-6514/GDR2_6514/GDR2_6514_GAIASOURCE/


    s3cmd \
        ls 's3://aglais-data-gaia-dr2-6514/GDR2_6514/GDR2_6514_GAIASOURCE/'


    >   2021-12-24 01:22     74114220  s3://aglais-data-gaia-dr2-6514/GDR2_6514/GDR2_6514_GAIASOURCE/part-00000-70392076-8b82-4457-8828-22069e7626e9-c000.snappy.parquet
    >   2021-12-24 01:22    104411815  s3://aglais-data-gaia-dr2-6514/GDR2_6514/GDR2_6514_GAIASOURCE/part-00001-70392076-8b82-4457-8828-22069e7626e9-c000.snappy.parquet
    >   ....
    >   ....
    >   2021-12-24 14:34     28448646  s3://aglais-data-gaia-dr2-6514/GDR2_6514/GDR2_6514_GAIASOURCE/part-06512-70392076-8b82-4457-8828-22069e7626e9-c000.snappy.parquet
    >   2021-12-24 14:34      6317774  s3://aglais-data-gaia-dr2-6514/GDR2_6514/GDR2_6514_GAIASOURCE/part-06513-70392076-8b82-4457-8828-22069e7626e9-c000.snappy.parquet


# -----------------------------------------------------
# Delete our old buckets.
#[user@zeppelin]

    s3cmd ls | grep 's3://aglais'

    >   2021-12-24 00:26  s3://aglais-data-gaia-dr2-6514
    >   2021-12-24 09:24  s3://aglais-data-gaia-edr3-11932
    >   2021-12-24 15:28  s3://aglais-data-gaia-edr3-2048
    >   2021-12-24 15:28  s3://aglais-data-gaia-edr3-4096
    >   2021-12-24 00:38  s3://aglais-user-nch
    >   2021-12-23 18:27  s3://aglais-user-zrq


    s3cmd ls | grep 's3://aglais' | cut -d ' ' -f 4

    >   s3://aglais-data-gaia-dr2-6514
    >   s3://aglais-data-gaia-edr3-11932
    >   s3://aglais-data-gaia-edr3-2048
    >   s3://aglais-data-gaia-edr3-4096
    >   s3://aglais-user-nch
    >   s3://aglais-user-zrq


    for bucketname in $(s3cmd ls | grep 's3://aglais' | cut -d ' ' -f 4)
    do
        echo "Bucket [${bucketname}]"
        s3cmd rb --recursive "${bucketname}"
    done


    >   ....
    >   ....


# -----------------------------------------------------
# Create some test data....
#[user@zeppelin]

    ls -1 /data/gaia/GDR3 | head -n 10

    >   GDR3_2MASSPSC_BEST_NEIGHBOURS
    >   GDR3_ALERTS_MIXEDIN_SOURCEIDS
    >   GDR3_ALLWISE_BEST_NEIGHBOURS
    >   GDR3_ASTROPHYSICAL_PARAMETERS
    >   GDR3_ASTROPHYSICAL_PARAMETERS_SUPP
    >   GDR3_EPOCH_PHOTOMETRY
    >   GDR3_GAIASOURCE
    >   GDR3_GAIA_SOURCE
    >   GDR3_GALAXY_CANDIDATES
    >   GDR3_GALAXY_CATALOGUE_NAME


    ls -1 /data/gaia/GDR3/GDR3_2MASSPSC_BEST_NEIGHBOURS | head -n 100

    >   _SUCCESS
    >   part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet
    >   part-00001-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00001.c000.snappy.parquet
    >   ....
    >   ....


    srcpath=/data/gaia/GDR3
    dstpath=/mnt/cinder/vdc/test-data

    sudo mkdir -p "${dstpath:?}"
    sudo chown 'fedora:fedora' "${dstpath:?}"
    sudo chmod 'u=rwxs,g=rxs,o=rx' "${dstpath:?}"

    for tablename in $(ls -1 "${srcpath}" | head -n 10)
    do
        echo ""
        echo "Table [${tablename}]"

        srctablepath=${srcpath}/${tablename}
        dtstablepath=${dstpath}/${tablename}

        mkdir -p "${dtstablepath}"

        for filename in $(ls -1 "${srctablepath}" | head -n 10)
        do

            echo "File  [${filename}]"
            #echo "Copy  [${srctablepath}/${filename}][${dtstablepath}/${filename}]"
            cp ${srctablepath}/${filename} \
               ${dtstablepath}/

            cp ${srctablepath}/.${filename}.crc \
               ${dtstablepath}/

        done
    done


    ls -al /mnt/cinder/vdc/test-data/GDR3_GAIA_SOURCE

    >   total 2722116
    >   drwxrwsr-x. 1 fedora fedora      2760 Nov 26 16:04 .
    >   drwsr-sr-x. 1 fedora fedora       498 Nov 26 16:04 ..
    >   -rw-r--r--. 1 fedora fedora         8 Nov 26 16:04 ._SUCCESS.crc
    >   -rw-r--r--. 1 fedora fedora   2397620 Nov 26 16:04 .part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2401512 Nov 26 16:04 .part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2405316 Nov 26 16:04 .part-00002-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00002.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2401032 Nov 26 16:04 .part-00003-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00003.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2398372 Nov 26 16:04 .part-00004-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00004.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2402264 Nov 26 16:04 .part-00005-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00005.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2404068 Nov 26 16:04 .part-00006-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00006.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2397444 Nov 26 16:04 .part-00007-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00007.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora   2400296 Nov 26 16:04 .part-00008-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00008.c000.snappy.parquet.crc
    >   -rw-r--r--. 1 fedora fedora         0 Nov 26 16:04 _SUCCESS
    >   -rw-r--r--. 1 fedora fedora 306894276 Nov 26 16:04 part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 307392418 Nov 26 16:04 part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 307879344 Nov 26 16:04 part-00002-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00002.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 307330799 Nov 26 16:04 part-00003-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00003.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 306990241 Nov 26 16:04 part-00004-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00004.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 307488261 Nov 26 16:04 part-00005-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00005.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 307719363 Nov 26 16:04 part-00006-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00006.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 306871524 Nov 26 16:04 part-00007-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00007.c000.snappy.parquet
    >   -rw-r--r--. 1 fedora fedora 307236816 Nov 26 16:04 part-00008-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00008.c000.snappy.parquet


# -----------------------------------------------------
# Remove the duplicate (copy of a symlink).
#[user@zeppelin]

    rm -rf /mnt/cinder/vdc/test-data/GDR3_GAIASOURCE


# -----------------------------------------------------
# One bucket with sub-directories.
#[user@zeppelin]

    bucketname=test-GDR3
    s3cmd mb "s3://${bucketname}"

    dstpath=/mnt/cinder/vdc/test-data

    pushd ${dstpath}

        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"

    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 144 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://test-GDR3/ ...
    >   INFO: Found 144 local files, 54 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 90 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './GDR3_ALERTS_MIXEDIN_SOURCEIDS/.part-00033-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00033.c000.snappy.parquet.crc' -> 's3://test-GDR3/GDR3_ALERTS_MIXEDIN_SOURCEIDS/.part-00033-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00033.c000.snappy.parquet.crc'  [1 of 90]
    >    20 of 20   100% in    0s   118.38 B/s  done
    >   upload: './GDR3_ALERTS_MIXEDIN_SOURCEIDS/.part-00045-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00045.c000.snappy.parquet.crc' -> 's3://test-GDR3/GDR3_ALERTS_MIXEDIN_SOURCEIDS/.part-00045-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00045.c000.snappy.parquet.crc'  [2 of 90]
    >    20 of 20   100% in    0s   188.75 B/s  done
    >   ....
    >   ....
    >   upload: './GDR3_GALAXY_CATALOGUE_NAME/part-00007-60cbce91-12b7-4fee-a309-b16682b50eab_00007.c000.snappy.parquet' -> 's3://test-GDR3/GDR3_GALAXY_CATALOGUE_NAME/part-00007-60cbce91-12b7-4fee-a309-b16682b50eab_00007.c000.snappy.parquet'  [89 of 90]
    >    4732 of 4732   100% in    0s    88.61 KB/s  done
    >   upload: './GDR3_GALAXY_CATALOGUE_NAME/part-00008-60cbce91-12b7-4fee-a309-b16682b50eab_00008.c000.snappy.parquet' -> 's3://test-GDR3/GDR3_GALAXY_CATALOGUE_NAME/part-00008-60cbce91-12b7-4fee-a309-b16682b50eab_00008.c000.snappy.parquet'  [90 of 90]
    >    4740 of 4740   100% in    0s    50.19 KB/s  done
    >   Done. Uploaded 2804263470 bytes in 103.9 seconds, 25.74 MB/s.
    >   Stats: Number of files: 144 (5852429888 bytes)
    >   Stats: Number of files transferred: 90 (2804263470 bytes)


# -----------------------------------------------------
# One bucket per table.
#[user@zeppelin]

    bucketprefix=test

    dstpath=/mnt/cinder/vdc/test-data

    for tablename in $(ls -1 "${dstpath}")
    do
        echo ""
        echo "Table [${tablename}]"

        bucketname=${bucketprefix}-${tablename}
        s3cmd mb "s3://${bucketname}"

        pushd "${dstpath}/${tablename}"
            s3cmd sync \
                --debug \
                --stats \
                --verbose \
                --progress \
                --recursive \
                --no-check-md5 \
                --exclude '_SUCCESS' \
                --exclude '._SUCCESS.crc' \
                --include '*.parquet' \
                --include '*.parquet.crc' \
                "." \
                "s3://${bucketname}"
        popd

    done

    >   Table [GDR3_2MASSPSC_BEST_NEIGHBOURS]
    >   Bucket 's3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS/' created
    >   /mnt/cinder/vdc/test-data/GDR3_2MASSPSC_BEST_NEIGHBOURS ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 9 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS/ ...
    >   INFO: Found 9 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 9 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet' -> 's3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS/part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet'  [part 1 of 2, 15MB] [1 of 9]
    >    15728640 of 15728640   100% in    0s    21.02 MB/s  done
    >   upload: './part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet' -> 's3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS/part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet'  [part 2 of 2, 14MB] [1 of 9]
    >    15325252 of 15325252   100% in    0s    21.73 MB/s  done
    >   ....
    >   ....


# -----------------------------------------------------
# List our test buckets.
#[user@zeppelin]

    s3cmd ls | grep 's3://test-'

    >   2022-11-26 15:58  s3://test-GDR3
    >   2022-11-26 18:58  s3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS
    >   2022-11-26 18:58  s3://test-GDR3_ALERTS_MIXEDIN_SOURCEIDS
    >   2022-11-26 18:58  s3://test-GDR3_ALLWISE_BEST_NEIGHBOURS
    >   2022-11-26 18:59  s3://test-GDR3_ASTROPHYSICAL_PARAMETERS
    >   2022-11-26 18:59  s3://test-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP
    >   2022-11-26 19:00  s3://test-GDR3_EPOCH_PHOTOMETRY
    >   2022-11-26 19:00  s3://test-GDR3_GAIA_SOURCE
    >   2022-11-26 19:02  s3://test-GDR3_GALAXY_CANDIDATES
    >   2022-11-26 19:02  s3://test-GDR3_GALAXY_CATALOGUE_NAME


# -----------------------------------------------------
# List our complex bucket.
#[user@zeppelin]

    s3cmd ls 's3://test-GDR3'

    >   DIR  s3://test-GDR3/GDR3_2MASSPSC_BEST_NEIGHBOURS/
    >   DIR  s3://test-GDR3/GDR3_ALERTS_MIXEDIN_SOURCEIDS/
    >   DIR  s3://test-GDR3/GDR3_ALLWISE_BEST_NEIGHBOURS/
    >   DIR  s3://test-GDR3/GDR3_ASTROPHYSICAL_PARAMETERS/
    >   DIR  s3://test-GDR3/GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/
    >   DIR  s3://test-GDR3/GDR3_EPOCH_PHOTOMETRY/
    >   DIR  s3://test-GDR3/GDR3_GAIA_SOURCE/
    >   DIR  s3://test-GDR3/GDR3_GALAXY_CANDIDATES/
    >   DIR  s3://test-GDR3/GDR3_GALAXY_CATALOGUE_NAME/


    s3cmd ls 's3://test-GDR3/GDR3_GAIA_SOURCE/'

    >   2022-11-26 18:55      2397620  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2401512  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2405316  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00002-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00002.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2401032  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00003-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00003.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2398372  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00004-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00004.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2402264  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00005-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00005.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2404068  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00006-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00006.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2397444  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00007-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00007.c000.snappy.parquet.crc
    >   2022-11-26 18:55      2400296  s3://test-GDR3/GDR3_GAIA_SOURCE/.part-00008-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00008.c000.snappy.parquet.crc
    >   2022-11-26 18:56    306894276  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet
    >   2022-11-26 18:56    307392418  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet
    >   2022-11-26 18:56    307879344  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00002-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00002.c000.snappy.parquet
    >   2022-11-26 18:56    307330799  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00003-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00003.c000.snappy.parquet
    >   2022-11-26 18:56    306990241  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00004-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00004.c000.snappy.parquet
    >   2022-11-26 18:56    307488261  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00005-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00005.c000.snappy.parquet
    >   2022-11-26 18:57    307719363  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00006-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00006.c000.snappy.parquet
    >   2022-11-26 18:57    306871524  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00007-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00007.c000.snappy.parquet
    >   2022-11-26 18:57    307236816  s3://test-GDR3/GDR3_GAIA_SOURCE/part-00008-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00008.c000.snappy.parquet


# -----------------------------------------------------
# List one of our simple buckets.
#[user@zeppelin]

    s3cmd ls 's3://test-GDR3_GAIA_SOURCE'

    >   2022-11-26 19:00      2397620  s3://test-GDR3_GAIA_SOURCE/.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2401512  s3://test-GDR3_GAIA_SOURCE/.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2405316  s3://test-GDR3_GAIA_SOURCE/.part-00002-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00002.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2401032  s3://test-GDR3_GAIA_SOURCE/.part-00003-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00003.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2398372  s3://test-GDR3_GAIA_SOURCE/.part-00004-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00004.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2402264  s3://test-GDR3_GAIA_SOURCE/.part-00005-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00005.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2404068  s3://test-GDR3_GAIA_SOURCE/.part-00006-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00006.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2397444  s3://test-GDR3_GAIA_SOURCE/.part-00007-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00007.c000.snappy.parquet.crc
    >   2022-11-26 19:00      2400296  s3://test-GDR3_GAIA_SOURCE/.part-00008-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00008.c000.snappy.parquet.crc
    >   2022-11-26 19:00    306894276  s3://test-GDR3_GAIA_SOURCE/part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet
    >   2022-11-26 19:01    307392418  s3://test-GDR3_GAIA_SOURCE/part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet
    >   2022-11-26 19:01    307879344  s3://test-GDR3_GAIA_SOURCE/part-00002-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00002.c000.snappy.parquet
    >   2022-11-26 19:01    307330799  s3://test-GDR3_GAIA_SOURCE/part-00003-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00003.c000.snappy.parquet
    >   2022-11-26 19:01    306990241  s3://test-GDR3_GAIA_SOURCE/part-00004-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00004.c000.snappy.parquet
    >   2022-11-26 19:01    307488261  s3://test-GDR3_GAIA_SOURCE/part-00005-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00005.c000.snappy.parquet
    >   2022-11-26 19:01    307719363  s3://test-GDR3_GAIA_SOURCE/part-00006-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00006.c000.snappy.parquet
    >   2022-11-26 19:01    306871524  s3://test-GDR3_GAIA_SOURCE/part-00007-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00007.c000.snappy.parquet
    >   2022-11-26 19:02    307236816  s3://test-GDR3_GAIA_SOURCE/part-00008-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00008.c000.snappy.parquet

    #
    # Harvest the IVOA metadata from the ESAC TAP service.
    # VOTable per table 'metadata.vot'
    #

# -----------------------------------------------------
# Delete our test buckets.
#[user@zeppelin]

    s3cmd ls | grep 's3://test'

    >   2022-11-26 15:58  s3://test-GDR3
    >   2022-11-26 18:58  s3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS
    >   2022-11-26 18:58  s3://test-GDR3_ALERTS_MIXEDIN_SOURCEIDS
    >   2022-11-26 18:58  s3://test-GDR3_ALLWISE_BEST_NEIGHBOURS
    >   2022-11-26 18:59  s3://test-GDR3_ASTROPHYSICAL_PARAMETERS
    >   2022-11-26 18:59  s3://test-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP
    >   2022-11-26 19:00  s3://test-GDR3_EPOCH_PHOTOMETRY
    >   2022-11-26 19:00  s3://test-GDR3_GAIA_SOURCE
    >   2022-11-26 19:02  s3://test-GDR3_GALAXY_CANDIDATES
    >   2022-11-26 19:02  s3://test-GDR3_GALAXY_CATALOGUE_NAME


    s3cmd ls | grep 's3://test' | cut -d ' ' -f 4

    >   s3://test-GDR3
    >   s3://test-GDR3_2MASSPSC_BEST_NEIGHBOURS
    >   s3://test-GDR3_ALERTS_MIXEDIN_SOURCEIDS
    >   s3://test-GDR3_ALLWISE_BEST_NEIGHBOURS
    >   s3://test-GDR3_ASTROPHYSICAL_PARAMETERS
    >   s3://test-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP
    >   s3://test-GDR3_EPOCH_PHOTOMETRY
    >   s3://test-GDR3_GAIA_SOURCE
    >   s3://test-GDR3_GALAXY_CANDIDATES
    >   s3://test-GDR3_GALAXY_CATALOGUE_NAME


    for bucketname in $(s3cmd ls | grep 's3://test' | cut -d ' ' -f 4)
    do
        echo "Bucket [${bucketname}]"
        s3cmd rb --recursive "${bucketname}"
    done

    >   Bucket [s3://test-GDR3]
    >   WARNING: Bucket is not empty. Removing all the objects from it first. This may take some time...
    >   delete: 's3://test-GDR3/GDR3_2MASSPSC_BEST_NEIGHBOURS/part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet'
    >   delete: 's3://test-GDR3/GDR3_2MASSPSC_BEST_NEIGHBOURS/part-00001-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00001.c000.snappy.parquet'
    >   ....
    >   ....


# -----------------------------------------------------
# -----------------------------------------------------
# Try our main table.
#[user@zeppelin]

    bucketprefix=Gaia

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_GAIA_SOURCE

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://Gaia-GDR3_GAIA_SOURCE/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc' -> 's3://Gaia-GDR3_GAIA_SOURCE/.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    2397620 of 2397620   100% in    0s    11.15 MB/s  done
    >   upload: './.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc' -> 's3://Gaia-GDR3_GAIA_SOURCE/.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    2401512 of 2401512   100% in    0s    14.17 MB/s  done
    >   ....
    >   ....


# -----------------------------------------------------
# -----------------------------------------------------

    #
    # Desktop failed - connection broken.
    #

# -----------------------------------------------------
# -----------------------------------------------------
# List our new bucket.
#[user@zeppelin]

    s3cmd ls

    >   2022-11-27 03:15  s3://Gaia-GDR3_GAIA_SOURCE
    >   2021-02-28 02:44  s3://gaia-edr3


    s3cmd ls s3://Gaia-GDR3_GAIA_SOURCE

    >   2022-11-27 03:15      2397620  s3://Gaia-GDR3_GAIA_SOURCE/.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc
    >   2022-11-27 03:15      2401512  s3://Gaia-GDR3_GAIA_SOURCE/.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc
    >   ....
    >   ....
    >   2022-11-27 03:25      2401784  s3://Gaia-GDR3_GAIA_SOURCE/.part-02046-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_02046.c000.snappy.parquet.crc
    >   2022-11-27 03:25      2403060  s3://Gaia-GDR3_GAIA_SOURCE/.part-02047-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_02047.c000.snappy.parquet.crc
    >   2022-11-27 03:25    306894276  s3://Gaia-GDR3_GAIA_SOURCE/part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet
    >   2022-11-27 03:25    307392418  s3://Gaia-GDR3_GAIA_SOURCE/part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet
    >   ....
    >   ....
    >   2022-11-27 05:45    307706352  s3://Gaia-GDR3_GAIA_SOURCE/part-00734-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00734.c000.snappy.parquet
    >   2022-11-27 05:45    307923720  s3://Gaia-GDR3_GAIA_SOURCE/part-00735-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00735.c000.snappy.parquet


    #
    # All 2048 crc file (part-00000..part-02047).
    # Only 700 parquet files (part-00000..part-00735)
    #


# -----------------------------------------------------
# Try our main table again.
#[user@zeppelin]

    bucketprefix=Gaia

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_GAIA_SOURCE

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://Gaia-GDR3_GAIA_SOURCE/ ...
    >   INFO: Found 4096 local files, 2784 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 1312 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './part-00736-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00736.c000.snappy.parquet' -> 's3://Gaia-GDR3_GAIA_SOURCE/part-00736-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00736.c000.snappy.parquet'  [part 1 of 20, 15MB] [1 of 1312]
    >    15728640 of 15728640   100% in    0s    23.90 MB/s  done
    >   upload: './part-00736-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00736.c000.snappy.parquet' -> 's3://Gaia-GDR3_GAIA_SOURCE/part-00736-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00736.c000.snappy.parquet'  [part 2 of 20, 15MB] [1 of 1312]
    >    15728640 of 15728640   100% in    0s    28.86 MB/s  done
    >   ....
    >   ....

    #
    # Looking at the data going through, we are still less that 50% of the way with this table.
    # If we want to re-brand the buckets now is the time to do it.
    # Once created S3 doesn't have the ability to rename a bucket.
    # So do it now or forever stick with the unbranded name.
    #
    # Why add the branding - we are planning to make these buckets public and register them in the IVOA.
    # In which case, just calling them 'Gaia' is technically correct, but it doesn't show who did the work.
    # Branding them as 'GaiaDMp' shows who created the data set.
    #


# -----------------------------------------------------
# Change direction - add our branding to the bucket name.
#[user@zeppelin]

    bucketprefix=GaiaDMp

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_GAIA_SOURCE

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_GAIA_SOURCE/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_GAIA_SOURCE/.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    2397620 of 2397620   100% in    0s    10.43 MB/s  done
    >   upload: './.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_GAIA_SOURCE/.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    2401512 of 2401512   100% in    0s    15.85 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_GAIA_SOURCE/part-02047-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_02047.c000.snappy.parquet'  [part 19 of 20, 15MB] [4096 of 4096]
    >    15728640 of 15728640   100% in    0s    31.04 MB/s  done
    >   upload: './part-02047-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_GAIA_SOURCE/part-02047-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_02047.c000.snappy.parquet'  [part 20 of 20, 8MB] [4096 of 4096]
    >    8746214 of 8746214   100% in    0s    27.60 MB/s  done
    >   Done. Uploaded 634489375956 bytes in 22285.3 seconds, 27.15 MB/s.
    >   Stats: Number of files: 4096 (634489375956 bytes)
    >   Stats: Number of files transferred: 4096 (634489375956 bytes)



# -----------------------------------------------------
# Try running a second transfer in another shell.
#[root@ansibler]

    podman exec -it \
        ansibler-green \
        bash

        ssh zeppelin


# -----------------------------------------------------
# Add another table, GDR3_ALERTS_MIXEDIN_SOURCEIDS, in a separate shell.
#[user@zeppelin]

    bucketprefix=GaiaDMp

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_ALERTS_MIXEDIN_SOURCEIDS

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 170 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_ALERTS_MIXEDIN_SOURCEIDS/ ...
    >   INFO: Found 170 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 170 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00033-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00033.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_ALERTS_MIXEDIN_SOURCEIDS/.part-00033-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00033.c000.snappy.parquet.crc'  [1 of 170]
    >    20 of 20   100% in    0s    79.32 B/s  done
    >   upload: './.part-00045-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00045.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_ALERTS_MIXEDIN_SOURCEIDS/.part-00045-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_00045.c000.snappy.parquet.crc'  [2 of 170]
    >    20 of 20   100% in    0s   234.28 B/s  done
    >   ....
    >   ....
    >   upload: './part-01939-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_01939.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ALERTS_MIXEDIN_SOURCEIDS/part-01939-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_01939.c000.snappy.parquet'  [169 of 170]
    >    1040 of 1040   100% in    0s    21.15 KB/s  done
    >   upload: './part-01975-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_01975.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ALERTS_MIXEDIN_SOURCEIDS/part-01975-e7254a6e-4d23-4a6c-99da-80da32dd2ee6_01975.c000.snappy.parquet'  [170 of 170]
    >    1040 of 1040   100% in    0s    20.37 KB/s  done
    >   Done. Uploaded 90268 bytes in 19.7 seconds, 4.48 KB/s.
    >   Stats: Number of files: 170 (90268 bytes)
    >   Stats: Number of files transferred: 170 (90268 bytes)

    #
    # Short table .. all done.
    #

# -----------------------------------------------------
# Add another table, GDR3_ASTROPHYSICAL_PARAMETERS.
#[user@zeppelin]

    tablename=GDR3_ASTROPHYSICAL_PARAMETERS

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-aa4f7869-f426-48a7-bec2-55f83ccdb062_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS/.part-00000-aa4f7869-f426-48a7-bec2-55f83ccdb062_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    765092 of 765092   100% in    0s     3.65 MB/s  done
    >   upload: './.part-00001-aa4f7869-f426-48a7-bec2-55f83ccdb062_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS/.part-00001-aa4f7869-f426-48a7-bec2-55f83ccdb062_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    765032 of 765032   100% in    0s     5.51 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-aa4f7869-f426-48a7-bec2-55f83ccdb062_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS/part-02047-aa4f7869-f426-48a7-bec2-55f83ccdb062_02047.c000.snappy.parquet'  [part 6 of 7, 15MB] [4096 of 4096]
    >    15728640 of 15728640   100% in    0s    32.69 MB/s  done
    >   upload: './part-02047-aa4f7869-f426-48a7-bec2-55f83ccdb062_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS/part-02047-aa4f7869-f426-48a7-bec2-55f83ccdb062_02047.c000.snappy.parquet'  [part 7 of 7, 3MB] [4096 of 4096]
    >    3698301 of 3698301   100% in    0s    18.47 MB/s  done
    >   Done. Uploaded 202270061815 bytes in 8459.5 seconds, 22.80 MB/s.
    >   Stats: Number of files: 4096 (202270061815 bytes)
    >   Stats: Number of files transferred: 4096 (202270061815 bytes)


# -----------------------------------------------------
# Try running a third transfer in another shell.
#[root@ansibler]

    podman exec -it \
        ansibler-green \
        bash

        ssh zeppelin


# -----------------------------------------------------
# Add another table, GDR3_ASTROPHYSICAL_PARAMETERS_SUPP, in the third shell.
#[user@zeppelin]

    bucketprefix=GaiaDMp

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_ASTROPHYSICAL_PARAMETERS_SUPP

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/.part-00000-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    666980 of 666980   100% in    0s     4.31 MB/s  done
    >   upload: './.part-00001-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/.part-00001-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    666420 of 666420   100% in    0s     6.99 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/part-02047-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_02047.c000.snappy.parquet'  [part 5 of 6, 15MB] [4096 of 4096]
    >    15728640 of 15728640   100% in    0s    25.76 MB/s  done
    >   upload: './part-02047-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/part-02047-d31cd84a-3bd6-4b8e-8b88-8956ea2cd155_02047.c000.snappy.parquet'  [part 6 of 6, 6MB] [4096 of 4096]
    >    6839071 of 6839071   100% in    0s    22.44 MB/s  done
    >   Done. Uploaded 176137210399 bytes in 7578.2 seconds, 22.17 MB/s.
    >   Stats: Number of files: 4096 (176137210399 bytes)
    >   Stats: Number of files transferred: 4096 (176137210399 bytes)


# -----------------------------------------------------
# Try running a fourth transfer in another shell.
#[root@ansibler]

    podman exec -it \
        ansibler-green \
        bash

        ssh zeppelin


# -----------------------------------------------------
# Add another table, GDR3_EPOCH_PHOTOMETRY, in the fourth shell.
#[user@zeppelin]

    bucketprefix=GaiaDMp

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_EPOCH_PHOTOMETRY

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_EPOCH_PHOTOMETRY/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-4f4d3777-2a28-4cac-b097-956b187ec521_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_EPOCH_PHOTOMETRY/.part-00000-4f4d3777-2a28-4cac-b097-956b187ec521_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    247268 of 247268   100% in    0s  1566.98 KB/s  done
    >   upload: './.part-00001-4f4d3777-2a28-4cac-b097-956b187ec521_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_EPOCH_PHOTOMETRY/.part-00001-4f4d3777-2a28-4cac-b097-956b187ec521_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    242172 of 242172   100% in    0s     4.72 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-4f4d3777-2a28-4cac-b097-956b187ec521_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_EPOCH_PHOTOMETRY/part-02047-4f4d3777-2a28-4cac-b097-956b187ec521_02047.c000.snappy.parquet'  [part 1 of 2, 15MB] [4096 of 4096]
    >    15728640 of 15728640   100% in    0s    29.75 MB/s  done
    >   upload: './part-02047-4f4d3777-2a28-4cac-b097-956b187ec521_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_EPOCH_PHOTOMETRY/part-02047-4f4d3777-2a28-4cac-b097-956b187ec521_02047.c000.snappy.parquet'  [part 2 of 2, 14MB] [4096 of 4096]
    >    15431699 of 15431699   100% in    0s    28.46 MB/s  done
    >   Done. Uploaded 65802184305 bytes in 3476.0 seconds, 18.05 MB/s.
    >   Stats: Number of files: 4096 (65802184305 bytes)
    >   Stats: Number of files transferred: 4096 (65802184305 bytes)


# -----------------------------------------------------
# Try running a fith transfer in another shell.
#[root@ansibler]

    podman exec -it \
        ansibler-green \
        bash

        ssh zeppelin


# -----------------------------------------------------
# Add another table, GDR3_GALAXY_CANDIDATES, in the fith shell.
#[user@zeppelin]

    bucketprefix=GaiaDMp

    dstpath=/data/gaia/GDR3/

    tablename=GDR3_GALAXY_CANDIDATES

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_GALAXY_CANDIDATES/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_GALAXY_CANDIDATES/.part-00000-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    1512 of 1512   100% in    0s    16.78 KB/s  done
    >   upload: './.part-00001-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_GALAXY_CANDIDATES/.part-00001-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    1504 of 1504   100% in    0s    45.73 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_GALAXY_CANDIDATES/part-02046-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_02046.c000.snappy.parquet'  [4095 of 4096]
    >    189207 of 189207   100% in    0s     2.57 MB/s  done
    >   upload: './part-02047-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_GALAXY_CANDIDATES/part-02047-85294a33-a3fe-43b7-9b3c-4d1b8ec630c5_02047.c000.snappy.parquet'  [4096 of 4096]
    >    189418 of 189418   100% in    0s  1394.48 KB/s  done
    >   Done. Uploaded 383973743 bytes in 417.0 seconds, 899.15 KB/s.
    >   Stats: Number of files: 4096 (383973743 bytes)
    >   Stats: Number of files transferred: 4096 (383973743 bytes)

    #
    # Small table - done.
    #

# -----------------------------------------------------
# Add another table, GDR3_GALAXY_CATALOGUE_NAME, in the fith shell.
#[user@zeppelin]

    tablename=GDR3_GALAXY_CATALOGUE_NAME

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_GALAXY_CATALOGUE_NAME/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-60cbce91-12b7-4fee-a309-b16682b50eab_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_GALAXY_CATALOGUE_NAME/.part-00000-60cbce91-12b7-4fee-a309-b16682b50eab_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    48 of 48   100% in    0s   537.85 B/s  done
    >   upload: './.part-00001-60cbce91-12b7-4fee-a309-b16682b50eab_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_GALAXY_CATALOGUE_NAME/.part-00001-60cbce91-12b7-4fee-a309-b16682b50eab_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    48 of 48   100% in    0s  1142.72 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-60cbce91-12b7-4fee-a309-b16682b50eab_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_GALAXY_CATALOGUE_NAME/part-02046-60cbce91-12b7-4fee-a309-b16682b50eab_02046.c000.snappy.parquet'  [4095 of 4096]
    >    4756 of 4756   100% in    0s    40.25 KB/s  done
    >   upload: './part-02047-60cbce91-12b7-4fee-a309-b16682b50eab_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_GALAXY_CATALOGUE_NAME/part-02047-60cbce91-12b7-4fee-a309-b16682b50eab_02047.c000.snappy.parquet'  [4096 of 4096]
    >    4724 of 4724   100% in    0s   116.75 KB/s  done
    >   Done. Uploaded 9518093 bytes in 411.9 seconds, 22.57 KB/s.
    >   Stats: Number of files: 4096 (9518093 bytes)
    >   Stats: Number of files transferred: 4096 (9518093 bytes)

    #
    # Small table - done.
    #

# -----------------------------------------------------
# Add another table, GDR3_GALAXY_CATALOGUE_NAME, in the fith shell.
#[user@zeppelin]

    tablename=GDR3_GALAXY_CATALOGUE_NAME

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   ....
    >   ....


# -----------------------------------------------------
# Add another table, GDR3_MCMC_SAMPLES_GSP_PHOT, in the fith shell.
#[user@zeppelin]

    tablename=GDR3_MCMC_SAMPLES_GSP_PHOT

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/.part-00000-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    11238000 of 11238000   100% in    0s    19.96 MB/s  done
    >   upload: './.part-00001-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/.part-00001-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    11175508 of 11175508   100% in    0s    25.62 MB/s  done
    >   ....
    >   ....
    >   upload: './part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet'  [part 36 of 91, 15MB] [485 of 1604]
    >    15728640 of 15728640   100% in    0s    20.31 MB/s  done
    >   ERROR:
    >   Upload of './part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet' part 36 failed. Use
    >     /usr/bin/s3cmd abortmp s3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet 2~UMcYUNLjZKEtVA60dID22VjtqjjJTaV
    >   to abort the upload, or
    >     /usr/bin/s3cmd --upload-id 2~UMcYUNLjZKEtVA60dID22VjtqjjJTaV put ...
    >   to continue the upload.
    >   ERROR: S3 error: 403 (QuotaExceeded)


# -----------------------------------------------------
# Add another table, GDR3_MCMC_SAMPLES_MSC, in the fourth shell.
#[user@zeppelin]

    tablename=GDR3_MCMC_SAMPLES_MSC

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_MCMC_SAMPLES_MSC/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_MSC/.part-00000-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    4808724 of 4808724   100% in    0s    12.81 MB/s  done
    >   upload: './.part-00001-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_MSC/.part-00001-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    4792760 of 4792760   100% in    0s     7.34 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_MSC/part-02047-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_02047.c000.snappy.parquet'  [part 39 of 40, 15MB] [1060 of 1060]
    >    15728640 of 15728640   100% in    0s    21.98 MB/s  done
    >   upload: './part-02047-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_MSC/part-02047-34d6fdae-44a1-4db1-bbf9-d2689e2b3bbd_02047.c000.snappy.parquet'  [part 40 of 40, 1404KB] [1060 of 1060]
    >    1437797 of 1437797   100% in    0s    10.35 MB/s  done
    >   Done. Uploaded 651581613001 bytes in 24759.1 seconds, 25.10 MB/s.
    >   Stats: Number of files: 4096 (1268897167126 bytes)
    >   Stats: Number of files transferred: 1060 (651581613001 bytes)


# -----------------------------------------------------
# Add another table, GDR3_NSS_ACCELERATION_ASTRO, in the second shell.
#[user@zeppelin]

    tablename=GDR3_NSS_ACCELERATION_ASTRO

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_NSS_ACCELERATION_ASTRO/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-a936fd18-7f13-4f02-a9c5-999a8e8f744b_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_ACCELERATION_ASTRO/.part-00000-a936fd18-7f13-4f02-a9c5-999a8e8f744b_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    392 of 392   100% in    0s     6.90 KB/s  done
    >   upload: './.part-00001-a936fd18-7f13-4f02-a9c5-999a8e8f744b_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_ACCELERATION_ASTRO/.part-00001-a936fd18-7f13-4f02-a9c5-999a8e8f744b_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    312 of 312   100% in    0s     4.87 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-a936fd18-7f13-4f02-a9c5-999a8e8f744b_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_ACCELERATION_ASTRO/part-02046-a936fd18-7f13-4f02-a9c5-999a8e8f744b_02046.c000.snappy.parquet'  [4095 of 4096]
    >    44423 of 44423   100% in    0s   952.99 KB/s  done
    >   upload: './part-02047-a936fd18-7f13-4f02-a9c5-999a8e8f744b_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_ACCELERATION_ASTRO/part-02047-a936fd18-7f13-4f02-a9c5-999a8e8f744b_02047.c000.snappy.parquet'  [4096 of 4096]
    >    45306 of 45306   100% in    0s  1033.50 KB/s  done
    >   Done. Uploaded 90653750 bytes in 394.7 seconds, 224.31 KB/s.
    >   Stats: Number of files: 4096 (90653750 bytes)
    >   Stats: Number of files transferred: 4096 (90653750 bytes)


# -----------------------------------------------------
# Add another table, GDR3_NSS_NON_LINEAR_SPECTRO, in the third shell.
#[user@zeppelin]

    tablename=GDR3_NSS_NON_LINEAR_SPECTRO

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_NSS_NON_LINEAR_SPECTRO/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-b59f3772-3902-4fc7-b7de-e0aa104c08cf_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_NON_LINEAR_SPECTRO/.part-00000-b59f3772-3902-4fc7-b7de-e0aa104c08cf_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    56 of 56   100% in    0s  1177.46 B/s  done
    >   upload: './.part-00001-b59f3772-3902-4fc7-b7de-e0aa104c08cf_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_NON_LINEAR_SPECTRO/.part-00001-b59f3772-3902-4fc7-b7de-e0aa104c08cf_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    56 of 56   100% in    0s   856.03 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-b59f3772-3902-4fc7-b7de-e0aa104c08cf_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_NON_LINEAR_SPECTRO/part-02046-b59f3772-3902-4fc7-b7de-e0aa104c08cf_02046.c000.snappy.parquet'  [4095 of 4096]
    >    6760 of 6760   100% in    0s   149.31 KB/s  done
    >   upload: './part-02047-b59f3772-3902-4fc7-b7de-e0aa104c08cf_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_NON_LINEAR_SPECTRO/part-02047-b59f3772-3902-4fc7-b7de-e0aa104c08cf_02047.c000.snappy.parquet'  [4096 of 4096]
    >    6245 of 6245   100% in    0s   101.53 KB/s  done
    >   Done. Uploaded 13065863 bytes in 388.6 seconds, 32.83 KB/s.
    >   Stats: Number of files: 4096 (13065863 bytes)
    >   Stats: Number of files transferred: 4096 (13065863 bytes)


# -----------------------------------------------------
# Add another table, GDR3_NSS_TWO_BODY_ORBIT, in the second shell.
#[user@zeppelin]

    tablename=GDR3_NSS_TWO_BODY_ORBIT

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_NSS_TWO_BODY_ORBIT/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-348e1965-e099-4d19-be12-3048868e922a_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_TWO_BODY_ORBIT/.part-00000-348e1965-e099-4d19-be12-3048868e922a_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    880 of 880   100% in    0s    12.32 KB/s  done
    >   upload: './.part-00001-348e1965-e099-4d19-be12-3048868e922a_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_TWO_BODY_ORBIT/.part-00001-348e1965-e099-4d19-be12-3048868e922a_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    756 of 756   100% in    0s   926.49 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-348e1965-e099-4d19-be12-3048868e922a_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_TWO_BODY_ORBIT/part-02046-348e1965-e099-4d19-be12-3048868e922a_02046.c000.snappy.parquet'  [4095 of 4096]
    >    90244 of 90244   100% in    0s     2.44 MB/s  done
    >   upload: './part-02047-348e1965-e099-4d19-be12-3048868e922a_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_TWO_BODY_ORBIT/part-02047-348e1965-e099-4d19-be12-3048868e922a_02047.c000.snappy.parquet'  [4096 of 4096]
    >    98975 of 98975   100% in    0s     2.72 MB/s  done
    >   Done. Uploaded 208862281 bytes in 425.1 seconds, 479.78 KB/s.
    >   Stats: Number of files: 4096 (208862281 bytes)
    >   Stats: Number of files transferred: 4096 (208862281 bytes)


# -----------------------------------------------------
# Add another table, GDR3_NSS_VIM_FL, in the third shell.
#[user@zeppelin]

    tablename=GDR3_NSS_VIM_FL

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 1408 files, this may take some time...
    >   INFO: [1000/1408]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_NSS_VIM_FL/ ...
    >   INFO: Found 1408 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 1408 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00002-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_00002.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_VIM_FL/.part-00002-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_00002.c000.snappy.parquet.crc'  [1 of 1408]
    >    64 of 64   100% in    0s   841.36 B/s  done
    >   upload: './.part-00004-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_00004.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_NSS_VIM_FL/.part-00004-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_00004.c000.snappy.parquet.crc'  [2 of 1408]
    >    64 of 64   100% in    0s   736.68 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_VIM_FL/part-02046-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_02046.c000.snappy.parquet'  [1407 of 1408]
    >    6764 of 6764   100% in    0s    71.52 KB/s  done
    >   upload: './part-02047-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_NSS_VIM_FL/part-02047-1fb9b8d1-49f6-4ce3-9c2b-9830d887c1d3_02047.c000.snappy.parquet'  [1408 of 1408]
    >    6764 of 6764   100% in    0s   146.84 KB/s  done
    >   Done. Uploaded 4856017 bytes in 142.3 seconds, 33.31 KB/s.
    >   Stats: Number of files: 1408 (4856017 bytes)
    >   Stats: Number of files transferred: 1408 (4856017 bytes)


# -----------------------------------------------------
# Add another table, GDR3_OA_NEURON_INFORMATION, in the third shell.
#[user@zeppelin]

    tablename=GDR3_OA_NEURON_INFORMATION

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_OA_NEURON_INFORMATION/ ...
    >   INFO: Found 2 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-01728-9d7753cf-4147-42ab-b932-322c037ec093_01728.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_OA_NEURON_INFORMATION/.part-01728-9d7753cf-4147-42ab-b932-322c037ec093_01728.c000.snappy.parquet.crc'  [1 of 2]
    >    2124 of 2124   100% in    0s    14.95 KB/s  done
    >   upload: './part-01728-9d7753cf-4147-42ab-b932-322c037ec093_01728.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_OA_NEURON_INFORMATION/part-01728-9d7753cf-4147-42ab-b932-322c037ec093_01728.c000.snappy.parquet'  [2 of 2]
    >    270407 of 270407   100% in    0s     2.15 MB/s  done
    >   Done. Uploaded 272531 bytes in 1.0 seconds, 266.14 KB/s.
    >   Stats: Number of files: 2 (272531 bytes)
    >   Stats: Number of files transferred: 2 (272531 bytes)


# -----------------------------------------------------
# Add another table, GDR3_OA_NEURON_XP_SPECTRA, in the third shell.
#[user@zeppelin]

    tablename=GDR3_OA_NEURON_XP_SPECTRA

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 1414 files, this may take some time...
    >   INFO: [1000/1414]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_OA_NEURON_XP_SPECTRA/ ...
    >   INFO: Found 1414 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 1414 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00002-d60604e5-b007-4589-b855-a2883d36002d_00002.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_OA_NEURON_XP_SPECTRA/.part-00002-d60604e5-b007-4589-b855-a2883d36002d_00002.c000.snappy.parquet.crc'  [1 of 1414]
    >    36 of 36   100% in    0s   834.90 B/s  done
    >   upload: './.part-00006-d60604e5-b007-4589-b855-a2883d36002d_00006.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_OA_NEURON_XP_SPECTRA/.part-00006-d60604e5-b007-4589-b855-a2883d36002d_00006.c000.snappy.parquet.crc'  [2 of 1414]
    >    44 of 44   100% in    0s   835.47 B/s  done
    >   ....
    >   ....
    >   upload: './part-02042-d60604e5-b007-4589-b855-a2883d36002d_02042.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_OA_NEURON_XP_SPECTRA/part-02042-d60604e5-b007-4589-b855-a2883d36002d_02042.c000.snappy.parquet'  [1413 of 1414]
    >    4128 of 4128   100% in    0s    93.65 KB/s  done
    >   upload: './part-02045-d60604e5-b007-4589-b855-a2883d36002d_02045.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_OA_NEURON_XP_SPECTRA/part-02045-d60604e5-b007-4589-b855-a2883d36002d_02045.c000.snappy.parquet'  [1414 of 1414]
    >    3221 of 3221   100% in    0s    48.37 KB/s  done
    >   Done. Uploaded 2416838 bytes in 137.0 seconds, 17.23 KB/s.
    >   Stats: Number of files: 1414 (2416838 bytes)
    >   Stats: Number of files transferred: 1414 (2416838 bytes)


# -----------------------------------------------------
# Add another table, GDR3_QSO_CANDIDATES, in the third shell.
#[user@zeppelin]

    tablename=GDR3_QSO_CANDIDATES

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_QSO_CANDIDATES/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-c5d15216-d51b-4f55-8c1c-50f91b0cb091_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_QSO_CANDIDATES/.part-00000-c5d15216-d51b-4f55-8c1c-50f91b0cb091_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    1188 of 1188   100% in    0s    12.35 KB/s  done
    >   upload: './.part-00001-c5d15216-d51b-4f55-8c1c-50f91b0cb091_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_QSO_CANDIDATES/.part-00001-c5d15216-d51b-4f55-8c1c-50f91b0cb091_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    1220 of 1220   100% in    0s    11.41 KB/s  done
    >   ....
    >   ....


# -----------------------------------------------------
# Add another table, GDR3_QSO_CATALOGUE_NAME, in the second shell.
#[user@zeppelin]

    tablename=GDR3_QSO_CATALOGUE_NAME

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_QSO_CATALOGUE_NAME/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-293f3f77-ebc6-4f98-86df-5c976028b804_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_QSO_CATALOGUE_NAME/.part-00000-293f3f77-ebc6-4f98-86df-5c976028b804_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    64 of 64   100% in    0s   601.11 B/s  done
    >   upload: './.part-00001-293f3f77-ebc6-4f98-86df-5c976028b804_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_QSO_CATALOGUE_NAME/.part-00001-293f3f77-ebc6-4f98-86df-5c976028b804_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    72 of 72   100% in    0s   942.06 B/s  done
    >   ....
    >   ....


# -----------------------------------------------------
# Add another table, GDR3_RVS_MEAN_SPECTRUM, in the second shell.
#[user@zeppelin]

    tablename=GDR3_RVS_MEAN_SPECTRUM

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_RVS_MEAN_SPECTRUM/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-3d95d90f-62d9-4b1a-b54d-1c0993cd5e95_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_RVS_MEAN_SPECTRUM/.part-00000-3d95d90f-62d9-4b1a-b54d-1c0993cd5e95_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    76536 of 76536   100% in    0s   124.09 KB/s  done
    >   upload: './.part-00001-3d95d90f-62d9-4b1a-b54d-1c0993cd5e95_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_RVS_MEAN_SPECTRUM/.part-00001-3d95d90f-62d9-4b1a-b54d-1c0993cd5e95_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    73076 of 73076   100% in    0s   112.19 KB/s  done
    >   ....
    >   ....


# -----------------------------------------------------
# Add another table, GDR3_SCIENCE_ALERTS, in the third shell.
#[user@zeppelin]

    tablename=GDR3_SCIENCE_ALERTS

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   >             "s3://${bucketname}"
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2972 files, this may take some time...
    >   INFO: [1000/2972]
    >   INFO: [2000/2972]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_SCIENCE_ALERTS/ ...
    >   INFO: Found 2972 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2972 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-0e643c78-6155-454b-9cec-c6526db7d9af_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SCIENCE_ALERTS/.part-00000-0e643c78-6155-454b-9cec-c6526db7d9af_00000.c000.snappy.parquet.crc'  [1 of 2972]
    >    20 of 20   100% in    0s   220.21 B/s  done
    >   upload: './.part-00002-0e643c78-6155-454b-9cec-c6526db7d9af_00002.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SCIENCE_ALERTS/.part-00002-0e643c78-6155-454b-9cec-c6526db7d9af_00002.c000.snappy.parquet.crc'  [2 of 2972]
    >    20 of 20   100% in    0s   209.66 B/s  done
    >   ....
    >   ....
    >   upload: './part-02045-0e643c78-6155-454b-9cec-c6526db7d9af_02045.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SCIENCE_ALERTS/part-02045-0e643c78-6155-454b-9cec-c6526db7d9af_02045.c000.snappy.parquet'  [2971 of 2972]
    >    1335 of 1335   100% in    0s    22.46 KB/s  done
    >   upload: './part-02047-0e643c78-6155-454b-9cec-c6526db7d9af_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SCIENCE_ALERTS/part-02047-0e643c78-6155-454b-9cec-c6526db7d9af_02047.c000.snappy.parquet'  [2972 of 2972]
    >    1252 of 1252   100% in    0s    15.98 KB/s  done
    >   Done. Uploaded 1896556 bytes in 273.6 seconds, 6.77 KB/s.
    >   Stats: Number of files: 2972 (1896556 bytes)
    >   Stats: Number of files transferred: 2972 (1896556 bytes)


# -----------------------------------------------------
# Add another table, GDR3_SSO_OBSERVATION, in the third shell.
#[user@zeppelin]

    tablename=GDR3_SSO_OBSERVATION

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_SSO_OBSERVATION/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-a1455612-b1b7-4d10-830e-e74925c5b6eb_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SSO_OBSERVATION/.part-00000-a1455612-b1b7-4d10-830e-e74925c5b6eb_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    20880 of 20880   100% in    0s   370.23 KB/s  done
    >   upload: './.part-00001-a1455612-b1b7-4d10-830e-e74925c5b6eb_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SSO_OBSERVATION/.part-00001-a1455612-b1b7-4d10-830e-e74925c5b6eb_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    17216 of 17216   100% in    0s   392.64 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-a1455612-b1b7-4d10-830e-e74925c5b6eb_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SSO_OBSERVATION/part-02046-a1455612-b1b7-4d10-830e-e74925c5b6eb_02046.c000.snappy.parquet'  [4095 of 4096]
    >    2307363 of 2307363   100% in    0s    18.63 MB/s  done
    >   upload: './part-02047-a1455612-b1b7-4d10-830e-e74925c5b6eb_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SSO_OBSERVATION/part-02047-a1455612-b1b7-4d10-830e-e74925c5b6eb_02047.c000.snappy.parquet'  [4096 of 4096]
    >    2465248 of 2465248   100% in    0s    17.39 MB/s  done
    >   Done. Uploaded 4599202824 bytes in 636.7 seconds, 6.89 MB/s.
    >   Stats: Number of files: 4096 (4599202824 bytes)
    >   Stats: Number of files transferred: 4096 (4599202824 bytes)


# -----------------------------------------------------
# Add another table, GDR3_SSO_REFLECTANCE_SPECTRUM, in the third shell.
#[user@zeppelin]

    tablename=GDR3_SSO_REFLECTANCE_SPECTRUM

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_SSO_REFLECTANCE_SPECTRUM/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-14c54c3e-9ea1-4805-9f3c-214cc32626a5_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SSO_REFLECTANCE_SPECTRUM/.part-00000-14c54c3e-9ea1-4805-9f3c-214cc32626a5_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    76 of 76   100% in    0s  1049.20 B/s  done
    >   upload: './.part-00001-14c54c3e-9ea1-4805-9f3c-214cc32626a5_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SSO_REFLECTANCE_SPECTRUM/.part-00001-14c54c3e-9ea1-4805-9f3c-214cc32626a5_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    72 of 72   100% in    0s   674.81 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-14c54c3e-9ea1-4805-9f3c-214cc32626a5_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SSO_REFLECTANCE_SPECTRUM/part-02046-14c54c3e-9ea1-4805-9f3c-214cc32626a5_02046.c000.snappy.parquet'  [4095 of 4096]
    >    7498 of 7498   100% in    0s   179.26 KB/s  done
    >   upload: './part-02047-14c54c3e-9ea1-4805-9f3c-214cc32626a5_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SSO_REFLECTANCE_SPECTRUM/part-02047-14c54c3e-9ea1-4805-9f3c-214cc32626a5_02047.c000.snappy.parquet'  [4096 of 4096]
    >    7622 of 7622   100% in    0s   146.69 KB/s  done
    >   Done. Uploaded 15879562 bytes in 362.7 seconds, 42.76 KB/s.
    >   Stats: Number of files: 4096 (15879562 bytes)
    >   Stats: Number of files transferred: 4096 (15879562 bytes)


# -----------------------------------------------------
# Add another table, GDR3_SSO_SOURCE, in the second shell.
#[user@zeppelin]

    tablename=GDR3_SSO_SOURCE

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_SSO_SOURCE/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SSO_SOURCE/.part-00000-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    40 of 40   100% in    0s   723.81 B/s  done
    >   upload: './.part-00001-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_SSO_SOURCE/.part-00001-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    40 of 40   100% in    0s   678.78 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SSO_SOURCE/part-02046-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_02046.c000.snappy.parquet'  [4095 of 4096]
    >    3732 of 3732   100% in    0s    64.17 KB/s  done
    >   upload: './part-02047-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_SSO_SOURCE/part-02047-b2c256b4-7cb2-4e0d-8f30-0fc5532f04fd_02047.c000.snappy.parquet'  [4096 of 4096]
    >    3864 of 3864   100% in    0s    66.62 KB/s  done
    >   Done. Uploaded 7593438 bytes in 356.6 seconds, 20.79 KB/s.
    >   Stats: Number of files: 4096 (7593438 bytes)
    >   Stats: Number of files transferred: 4096 (7593438 bytes)


# -----------------------------------------------------
# Add another table, GDR3_TOTAL_GALACTIC_EXTINCTION_MAP, in the third shell.
#[user@zeppelin]

    tablename=GDR3_TOTAL_GALACTIC_EXTINCTION_MAP

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-672ab79b-239e-49b8-ac29-524768eb6f54_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP/.part-00000-672ab79b-239e-49b8-ac29-524768eb6f54_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    260 of 260   100% in    0s     6.23 KB/s  done
    >   upload: './.part-00001-672ab79b-239e-49b8-ac29-524768eb6f54_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP/.part-00001-672ab79b-239e-49b8-ac29-524768eb6f54_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    256 of 256   100% in    0s     2.36 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-672ab79b-239e-49b8-ac29-524768eb6f54_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP/part-02046-672ab79b-239e-49b8-ac29-524768eb6f54_02046.c000.snappy.parquet'  [4095 of 4096]
    >    33873 of 33873   100% in    0s   290.34 KB/s  done
    >   upload: './part-02047-672ab79b-239e-49b8-ac29-524768eb6f54_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP/part-02047-672ab79b-239e-49b8-ac29-524768eb6f54_02047.c000.snappy.parquet'  [4096 of 4096]
    >    29793 of 29793   100% in    0s   608.41 KB/s  done
    >   Done. Uploaded 64652364 bytes in 369.0 seconds, 171.12 KB/s.
    >   Stats: Number of files: 4096 (64652364 bytes)
    >   Stats: Number of files transferred: 4096 (64652364 bytes)


# -----------------------------------------------------
# Add another table, GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT, in the second shell.
#[user@zeppelin]

    tablename=GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-d4e4a994-079e-4946-8038-2368cf6c15e2_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT/.part-00000-d4e4a994-079e-4946-8038-2368cf6c15e2_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    184 of 184   100% in    0s     2.59 KB/s  done
    >   upload: './.part-00001-d4e4a994-079e-4946-8038-2368cf6c15e2_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT/.part-00001-d4e4a994-079e-4946-8038-2368cf6c15e2_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    184 of 184   100% in    0s  1935.97 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-d4e4a994-079e-4946-8038-2368cf6c15e2_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT/part-02046-d4e4a994-079e-4946-8038-2368cf6c15e2_02046.c000.snappy.parquet'  [4095 of 4096]
    >    23361 of 23361   100% in    0s   187.17 KB/s  done
    >   upload: './part-02047-d4e4a994-079e-4946-8038-2368cf6c15e2_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT/part-02047-d4e4a994-079e-4946-8038-2368cf6c15e2_02047.c000.snappy.parquet'  [4096 of 4096]
    >    21604 of 21604   100% in    0s   491.53 KB/s  done
    >   Done. Uploaded 45771841 bytes in 539.8 seconds, 82.81 KB/s.
    >   Stats: Number of files: 4096 (45771841 bytes)
    >   Stats: Number of files transferred: 4096 (45771841 bytes)


# -----------------------------------------------------
# Add another table, GDR3_VARI_AGN, in the third shell.
#[user@zeppelin]

    tablename=GDR3_VARI_AGN

    bucketname=${bucketprefix}-${tablename}
    s3cmd mb \
        --acl-public \
        "s3://${bucketname}"

    pushd "${dstpath}/${tablename}"
        s3cmd sync \
            --debug \
            --stats \
            --verbose \
            --progress \
            --recursive \
            --acl-public \
            --no-check-md5 \
            --exclude '_SUCCESS' \
            --exclude '._SUCCESS.crc' \
            --include '*.parquet' \
            --include '*.parquet.crc' \
            "." \
            "s3://${bucketname}"
    popd

    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_AGN/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-e5e2f02a-27a8-4faf-b970-3548228043c4_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_AGN/.part-00000-e5e2f02a-27a8-4faf-b970-3548228043c4_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    120 of 120   100% in    0s     2.01 KB/s  done
    >   upload: './.part-00001-e5e2f02a-27a8-4faf-b970-3548228043c4_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_AGN/.part-00001-e5e2f02a-27a8-4faf-b970-3548228043c4_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    120 of 120   100% in    0s     2.27 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-e5e2f02a-27a8-4faf-b970-3548228043c4_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_AGN/part-02046-e5e2f02a-27a8-4faf-b970-3548228043c4_02046.c000.snappy.parquet'  [4095 of 4096]
    >    13234 of 13234   100% in    0s   283.16 KB/s  done
    >   upload: './part-02047-e5e2f02a-27a8-4faf-b970-3548228043c4_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_AGN/part-02047-e5e2f02a-27a8-4faf-b970-3548228043c4_02047.c000.snappy.parquet'  [4096 of 4096]
    >    13570 of 13570   100% in    0s   137.47 KB/s  done
    >   Done. Uploaded 28947150 bytes in 348.1 seconds, 81.21 KB/s.
    >   Stats: Number of files: 4096 (28947150 bytes)
    >   Stats: Number of files transferred: 4096 (28947150 bytes)


# -----------------------------------------------------
# Create a shell script function.
#[user@zeppelin]

    bucketprefix=GaiaDMp
    dstpath=/data/gaia/GDR3/

    uploadtable()
        {
        local tablename=${1:?'tablename required'}
        local bucketname=${bucketprefix}-${tablename}
        s3cmd mb \
            --acl-public \
            "s3://${bucketname}"

        pushd "${dstpath}/${tablename}"
            s3cmd sync \
                --debug \
                --stats \
                --verbose \
                --progress \
                --recursive \
                --acl-public \
                --no-check-md5 \
                --exclude '_SUCCESS' \
                --exclude '._SUCCESS.crc' \
                --include '*.parquet' \
                --include '*.parquet.crc' \
                "." \
                "s3://${bucketname}"
        popd
        }


# -----------------------------------------------------
# Add another table in the first shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_CEPHEID

    >   Bucket 's3://GaiaDMp-GDR3_VARI_CEPHEID/' created
    >   /data/gaia/GDR3/GDR3_VARI_CEPHEID ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4094 files, this may take some time...
    >   INFO: [1000/4094]
    >   INFO: [2000/4094]
    >   INFO: [3000/4094]
    >   INFO: [4000/4094]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_CEPHEID/ ...
    >   INFO: Found 4094 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4094 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_CEPHEID/.part-00000-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_00000.c000.snappy.parquet.crc'  [1 of 4094]
    >    200 of 200   100% in    0s  1836.77 B/s  done
    >   upload: './.part-00001-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_CEPHEID/.part-00001-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_00001.c000.snappy.parquet.crc'  [2 of 4094]
    >    192 of 192   100% in    0s  1960.60 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_CEPHEID/part-02046-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_02046.c000.snappy.parquet'  [4093 of 4094]
    >    23539 of 23539   100% in    0s   322.03 KB/s  done
    >   upload: './part-02047-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_CEPHEID/part-02047-81c6406b-db6c-4ac0-b7a0-80cac2c1eb84_02047.c000.snappy.parquet'  [4094 of 4094]
    >    23556 of 23556   100% in    0s   277.26 KB/s  done
    >   Done. Uploaded 50433048 bytes in 492.0 seconds, 100.11 KB/s.
    >   Stats: Number of files: 4094 (50433048 bytes)
    >   Stats: Number of files transferred: 4094 (50433048 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_CLASSIFIER_CLASS_DEFINITION

    >   Bucket 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_CLASS_DEFINITION/' created
    >   /data/gaia/GDR3/GDR3_VARI_CLASSIFIER_CLASS_DEFINITION ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_CLASSIFIER_CLASS_DEFINITION/ ...
    >   INFO: Found 2 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-01106-f6fc00d6-4259-4e09-967b-e89d8fb3894d_01106.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_CLASS_DEFINITION/.part-01106-f6fc00d6-4259-4e09-967b-e89d8fb3894d_01106.c000.snappy.parquet.crc'  [1 of 2]
    >    32 of 32   100% in    0s   421.44 B/s  done
    >   upload: './part-01106-f6fc00d6-4259-4e09-967b-e89d8fb3894d_01106.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_CLASS_DEFINITION/part-01106-f6fc00d6-4259-4e09-967b-e89d8fb3894d_01106.c000.snappy.parquet'  [2 of 2]
    >    2708 of 2708   100% in    0s    52.99 KB/s  done
    >   Done. Uploaded 2740 bytes in 1.0 seconds, 2.68 KB/s.
    >   Stats: Number of files: 2 (2740 bytes)
    >   Stats: Number of files transferred: 2 (2740 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_CLASSIFIER_DEFINITION

    >   Bucket 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_DEFINITION/' created
    >   /data/gaia/GDR3/GDR3_VARI_CLASSIFIER_DEFINITION ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_CLASSIFIER_DEFINITION/ ...
    >   INFO: Found 2 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-01106-65f2a13f-b29d-4abc-b309-d0f07d0e3bb5_01106.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_DEFINITION/.part-01106-65f2a13f-b29d-4abc-b309-d0f07d0e3bb5_01106.c000.snappy.parquet.crc'  [1 of 2]
    >    32 of 32   100% in    0s   510.86 B/s  done
    >   upload: './part-01106-65f2a13f-b29d-4abc-b309-d0f07d0e3bb5_01106.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_DEFINITION/part-01106-65f2a13f-b29d-4abc-b309-d0f07d0e3bb5_01106.c000.snappy.parquet'  [2 of 2]
    >    2713 of 2713   100% in    0s    63.07 KB/s  done
    >   Done. Uploaded 2745 bytes in 1.0 seconds, 2.68 KB/s.
    >   Stats: Number of files: 2 (2745 bytes)
    >   Stats: Number of files transferred: 2 (2745 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_CLASSIFIER_RESULT

    >   Bucket 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_RESULT/' created
    >   /data/gaia/GDR3/GDR3_VARI_CLASSIFIER_RESULT ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_CLASSIFIER_RESULT/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-989c2a4e-1260-4550-987d-8e9b00eb6582_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_RESULT/.part-00000-989c2a4e-1260-4550-987d-8e9b00eb6582_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    500 of 500   100% in    0s  1599.46 B/s  done
    >   upload: './.part-00001-989c2a4e-1260-4550-987d-8e9b00eb6582_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_RESULT/.part-00001-989c2a4e-1260-4550-987d-8e9b00eb6582_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    492 of 492   100% in    0s    12.44 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-989c2a4e-1260-4550-987d-8e9b00eb6582_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_RESULT/part-02046-989c2a4e-1260-4550-987d-8e9b00eb6582_02046.c000.snappy.parquet'  [4095 of 4096]
    >    63184 of 63184   100% in    0s  1334.38 KB/s  done
    >   upload: './part-02047-989c2a4e-1260-4550-987d-8e9b00eb6582_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_CLASSIFIER_RESULT/part-02047-989c2a4e-1260-4550-987d-8e9b00eb6582_02047.c000.snappy.parquet'  [4096 of 4096]
    >    62408 of 62408   100% in    0s  1184.46 KB/s  done
    >   Done. Uploaded 130162202 bytes in 445.4 seconds, 285.39 KB/s.
    >   Stats: Number of files: 4096 (130162202 bytes)
    >   Stats: Number of files transferred: 4096 (130162202 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_COMPACT_COMPANION

    >   Bucket 's3://GaiaDMp-GDR3_VARI_COMPACT_COMPANION/' created
    >   /data/gaia/GDR3/GDR3_VARI_COMPACT_COMPANION ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 3898 files, this may take some time...
    >   INFO: [1000/3898]
    >   INFO: [2000/3898]
    >   INFO: [3000/3898]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_COMPACT_COMPANION/ ...
    >   INFO: Found 3898 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 3898 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_COMPACT_COMPANION/.part-00000-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_00000.c000.snappy.parquet.crc'  [1 of 3898]
    >    76 of 76   100% in    0s   521.54 B/s  done
    >   upload: './.part-00001-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_COMPACT_COMPANION/.part-00001-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_00001.c000.snappy.parquet.crc'  [2 of 3898]
    >    72 of 72   100% in    0s  1512.61 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_COMPACT_COMPANION/part-02046-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_02046.c000.snappy.parquet'  [3897 of 3898]
    >    8163 of 8163   100% in    0s    58.62 KB/s  done
    >   upload: './part-02047-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_COMPACT_COMPANION/part-02047-7a36ccf2-0c33-40a2-ab8f-98594231d7e3_02047.c000.snappy.parquet'  [3898 of 3898]
    >    7890 of 7890   100% in    0s    51.29 KB/s  done
    >   Done. Uploaded 15576427 bytes in 420.5 seconds, 36.17 KB/s.
    >   Stats: Number of files: 3898 (15576427 bytes)
    >   Stats: Number of files transferred: 3898 (15576427 bytes)




# -----------------------------------------------------
# Add another table in the first shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_ECLIPSING_BINARY

    >   Bucket 's3://GaiaDMp-GDR3_VARI_ECLIPSING_BINARY/' created
    >   /data/gaia/GDR3/GDR3_VARI_ECLIPSING_BINARY ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_ECLIPSING_BINARY/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-5a16f741-d356-4fc3-a260-7de79d121bcd_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_ECLIPSING_BINARY/.part-00000-5a16f741-d356-4fc3-a260-7de79d121bcd_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    1244 of 1244   100% in    0s     3.70 KB/s  done
    >   upload: './.part-00001-5a16f741-d356-4fc3-a260-7de79d121bcd_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_ECLIPSING_BINARY/.part-00001-5a16f741-d356-4fc3-a260-7de79d121bcd_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    1260 of 1260   100% in    0s  1273.51 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-5a16f741-d356-4fc3-a260-7de79d121bcd_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_ECLIPSING_BINARY/part-02046-5a16f741-d356-4fc3-a260-7de79d121bcd_02046.c000.snappy.parquet'  [4095 of 4096]
    >    165375 of 165375   100% in    0s     2.53 MB/s  done
    >   upload: './part-02047-5a16f741-d356-4fc3-a260-7de79d121bcd_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_ECLIPSING_BINARY/part-02047-5a16f741-d356-4fc3-a260-7de79d121bcd_02047.c000.snappy.parquet'  [4096 of 4096]
    >    162315 of 162315   100% in    0s   998.33 KB/s  done
    >   Done. Uploaded 337798089 bytes in 470.9 seconds, 700.54 KB/s.
    >   Stats: Number of files: 4096 (337798089 bytes)
    >   Stats: Number of files transferred: 4096 (337798089 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_EPOCH_RADIAL_VELOCITY

    >   Bucket 's3://GaiaDMp-GDR3_VARI_EPOCH_RADIAL_VELOCITY/' created
    >   /data/gaia/GDR3/GDR3_VARI_EPOCH_RADIAL_VELOCITY ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_EPOCH_RADIAL_VELOCITY/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-32b6d2cf-704f-455e-8829-375d9a39db6d_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_EPOCH_RADIAL_VELOCITY/.part-00000-32b6d2cf-704f-455e-8829-375d9a39db6d_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    32 of 32   100% in    0s   433.99 B/s  done
    >   upload: './.part-00001-32b6d2cf-704f-455e-8829-375d9a39db6d_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_EPOCH_RADIAL_VELOCITY/.part-00001-32b6d2cf-704f-455e-8829-375d9a39db6d_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    32 of 32   100% in    0s   435.54 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-32b6d2cf-704f-455e-8829-375d9a39db6d_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_EPOCH_RADIAL_VELOCITY/part-02046-32b6d2cf-704f-455e-8829-375d9a39db6d_02046.c000.snappy.parquet'  [4095 of 4096]
    >    2738 of 2738   100% in    0s    18.30 KB/s  done
    >   upload: './part-02047-32b6d2cf-704f-455e-8829-375d9a39db6d_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_EPOCH_RADIAL_VELOCITY/part-02047-32b6d2cf-704f-455e-8829-375d9a39db6d_02047.c000.snappy.parquet'  [4096 of 4096]
    >    2938 of 2938   100% in    0s     8.27 KB/s  done
    >   Done. Uploaded 6012251 bytes in 394.4 seconds, 14.89 KB/s.
    >   Stats: Number of files: 4096 (6012251 bytes)
    >   Stats: Number of files transferred: 4096 (6012251 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_LONG_PERIOD_VARIABLE

    >   Bucket 's3://GaiaDMp-GDR3_VARI_LONG_PERIOD_VARIABLE/' created
    >   /data/gaia/GDR3/GDR3_VARI_LONG_PERIOD_VARIABLE ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_LONG_PERIOD_VARIABLE/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-d5a553c3-726a-4034-9b7d-d18eef9250d7_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_LONG_PERIOD_VARIABLE/.part-00000-d5a553c3-726a-4034-9b7d-d18eef9250d7_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    128 of 128   100% in    0s   893.40 B/s  done
    >   upload: './.part-00001-d5a553c3-726a-4034-9b7d-d18eef9250d7_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_LONG_PERIOD_VARIABLE/.part-00001-d5a553c3-726a-4034-9b7d-d18eef9250d7_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    124 of 124   100% in    0s  1172.75 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-d5a553c3-726a-4034-9b7d-d18eef9250d7_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_LONG_PERIOD_VARIABLE/part-02046-d5a553c3-726a-4034-9b7d-d18eef9250d7_02046.c000.snappy.parquet'  [4095 of 4096]
    >    14128 of 14128   100% in    0s   212.11 KB/s  done
    >   upload: './part-02047-d5a553c3-726a-4034-9b7d-d18eef9250d7_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_LONG_PERIOD_VARIABLE/part-02047-d5a553c3-726a-4034-9b7d-d18eef9250d7_02047.c000.snappy.parquet'  [4096 of 4096]
    >    14679 of 14679   100% in    0s   119.03 KB/s  done
    >   Done. Uploaded 30991965 bytes in 407.1 seconds, 74.35 KB/s.
    >   Stats: Number of files: 4096 (30991965 bytes)
    >   Stats: Number of files transferred: 4096 (30991965 bytes)


# -----------------------------------------------------
# Add another table in the first shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_MICROLENSING

    >   Bucket 's3://GaiaDMp-GDR3_VARI_MICROLENSING/' created
    >   /data/gaia/GDR3/GDR3_VARI_MICROLENSING ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 658 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_MICROLENSING/ ...
    >   INFO: Found 658 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 658 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00006-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_00006.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_MICROLENSING/.part-00006-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_00006.c000.snappy.parquet.crc'  [1 of 658]
    >    84 of 84   100% in    0s   609.86 B/s  done
    >   upload: './.part-00007-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_00007.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_MICROLENSING/.part-00007-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_00007.c000.snappy.parquet.crc'  [2 of 658]
    >    80 of 80   100% in    0s  1384.85 B/s  done
    >   ....
    >   ....
    >   upload: './part-02039-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_02039.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_MICROLENSING/part-02039-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_02039.c000.snappy.parquet'  [657 of 658]
    >    9190 of 9190   100% in    0s   217.19 KB/s  done
    >   upload: './part-02043-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_02043.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_MICROLENSING/part-02043-c4c131ae-11bb-485a-b4fd-83b98c6fb8c2_02043.c000.snappy.parquet'  [658 of 658]
    >    8566 of 8566   100% in    0s   114.74 KB/s  done
    >   Done. Uploaded 2945286 bytes in 77.3 seconds, 37.23 KB/s.
    >   Stats: Number of files: 658 (2945286 bytes)
    >   Stats: Number of files transferred: 658 (2945286 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_MS_OSCILLATOR

    >   Bucket 's3://GaiaDMp-GDR3_VARI_MS_OSCILLATOR/' created
    >   /data/gaia/GDR3/GDR3_VARI_MS_OSCILLATOR ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_MS_OSCILLATOR/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-dc0a8a60-9001-4e37-be4e-7e0f16579747_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_MS_OSCILLATOR/.part-00000-dc0a8a60-9001-4e37-be4e-7e0f16579747_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    40 of 40   100% in    0s   476.19 B/s  done
    >   upload: './.part-00001-dc0a8a60-9001-4e37-be4e-7e0f16579747_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_MS_OSCILLATOR/.part-00001-dc0a8a60-9001-4e37-be4e-7e0f16579747_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    40 of 40   100% in    0s   510.55 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-dc0a8a60-9001-4e37-be4e-7e0f16579747_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_MS_OSCILLATOR/part-02046-dc0a8a60-9001-4e37-be4e-7e0f16579747_02046.c000.snappy.parquet'  [4095 of 4096]
    >    3750 of 3750   100% in    0s    83.76 KB/s  done
    >   upload: './part-02047-dc0a8a60-9001-4e37-be4e-7e0f16579747_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_MS_OSCILLATOR/part-02047-dc0a8a60-9001-4e37-be4e-7e0f16579747_02047.c000.snappy.parquet'  [4096 of 4096]
    >    3718 of 3718   100% in    0s    39.89 KB/s  done
    >   Done. Uploaded 7833520 bytes in 512.6 seconds, 14.92 KB/s.
    >   Stats: Number of files: 4096 (7833520 bytes)
    >   Stats: Number of files transferred: 4096 (7833520 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_PLANETARY_TRANSIT

    >   Bucket 's3://GaiaDMp-GDR3_VARI_PLANETARY_TRANSIT/' created
    >   /data/gaia/GDR3/GDR3_VARI_PLANETARY_TRANSIT ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 416 files, this may take some time...
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_PLANETARY_TRANSIT/ ...
    >   INFO: Found 416 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 416 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00001-66dbb391-ea9c-4842-9bb7-00ab85c080d2_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_PLANETARY_TRANSIT/.part-00001-66dbb391-ea9c-4842-9bb7-00ab85c080d2_00001.c000.snappy.parquet.crc'  [1 of 416]
    >    24 of 24   100% in    0s   178.14 B/s  done
    >   upload: './.part-00004-66dbb391-ea9c-4842-9bb7-00ab85c080d2_00004.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_PLANETARY_TRANSIT/.part-00004-66dbb391-ea9c-4842-9bb7-00ab85c080d2_00004.c000.snappy.parquet.crc'  [2 of 416]
    >    24 of 24   100% in    0s   146.53 B/s  done
    >   ....
    >   ....
    >   upload: './part-02033-66dbb391-ea9c-4842-9bb7-00ab85c080d2_02033.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_PLANETARY_TRANSIT/part-02033-66dbb391-ea9c-4842-9bb7-00ab85c080d2_02033.c000.snappy.parquet'  [415 of 416]
    >    1999 of 1999   100% in    0s     3.24 KB/s  done
    >   upload: './part-02040-66dbb391-ea9c-4842-9bb7-00ab85c080d2_02040.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_PLANETARY_TRANSIT/part-02040-66dbb391-ea9c-4842-9bb7-00ab85c080d2_02040.c000.snappy.parquet'  [416 of 416]
    >    1999 of 1999   100% in    0s    37.73 KB/s  done
    >   Done. Uploaded 421168 bytes in 53.0 seconds, 7.76 KB/s.
    >   Stats: Number of files: 416 (421168 bytes)
    >   Stats: Number of files transferred: 416 (421168 bytes)



# -----------------------------------------------------
# Add another table in the first shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_RAD_VEL_STATISTICS

    >   Bucket 's3://GaiaDMp-GDR3_VARI_RAD_VEL_STATISTICS/' created
    >   /data/gaia/GDR3/GDR3_VARI_RAD_VEL_STATISTICS ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2482 files, this may take some time...
    >   INFO: [1000/2482]
    >   INFO: [2000/2482]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_RAD_VEL_STATISTICS/ ...
    >   INFO: Found 2482 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2482 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-bdceda36-e75b-48e7-8b6b-168e6f72eab5_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_RAD_VEL_STATISTICS/.part-00000-bdceda36-e75b-48e7-8b6b-168e6f72eab5_00000.c000.snappy.parquet.crc'  [1 of 2482]
    >    40 of 40   100% in    0s   654.24 B/s  done
    >   upload: './.part-00004-bdceda36-e75b-48e7-8b6b-168e6f72eab5_00004.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_RAD_VEL_STATISTICS/.part-00004-bdceda36-e75b-48e7-8b6b-168e6f72eab5_00004.c000.snappy.parquet.crc'  [2 of 2482]
    >    40 of 40   100% in    0s   956.55 B/s  done
    >   ....
    >   ....
    >   upload: './part-02045-bdceda36-e75b-48e7-8b6b-168e6f72eab5_02045.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_RAD_VEL_STATISTICS/part-02045-bdceda36-e75b-48e7-8b6b-168e6f72eab5_02045.c000.snappy.parquet'  [2481 of 2482]
    >    3821 of 3821   100% in    0s    54.67 KB/s  done
    >   upload: './part-02046-bdceda36-e75b-48e7-8b6b-168e6f72eab5_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_RAD_VEL_STATISTICS/part-02046-bdceda36-e75b-48e7-8b6b-168e6f72eab5_02046.c000.snappy.parquet'  [2482 of 2482]
    >    3821 of 3821   100% in    0s    63.33 KB/s  done
    >   Done. Uploaded 4850574 bytes in 269.8 seconds, 17.56 KB/s.
    >   Stats: Number of files: 2482 (4850574 bytes)
    >   Stats: Number of files transferred: 2482 (4850574 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_ROTATION_MODULATION

    >   Bucket 's3://GaiaDMp-GDR3_VARI_ROTATION_MODULATION/' created
    >   /data/gaia/GDR3/GDR3_VARI_ROTATION_MODULATION ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_ROTATION_MODULATION/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-544581bb-72eb-47f5-96d5-1f604dd45c38_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_ROTATION_MODULATION/.part-00000-544581bb-72eb-47f5-96d5-1f604dd45c38_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    2108 of 2108   100% in    0s    26.16 KB/s  done
    >   upload: './.part-00001-544581bb-72eb-47f5-96d5-1f604dd45c38_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_ROTATION_MODULATION/.part-00001-544581bb-72eb-47f5-96d5-1f604dd45c38_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    2088 of 2088   100% in    0s    44.24 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-544581bb-72eb-47f5-96d5-1f604dd45c38_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_ROTATION_MODULATION/part-02046-544581bb-72eb-47f5-96d5-1f604dd45c38_02046.c000.snappy.parquet'  [4095 of 4096]
    >    294497 of 294497   100% in    0s     2.26 MB/s  done
    >   upload: './part-02047-544581bb-72eb-47f5-96d5-1f604dd45c38_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_ROTATION_MODULATION/part-02047-544581bb-72eb-47f5-96d5-1f604dd45c38_02047.c000.snappy.parquet'  [4096 of 4096]
    >    296452 of 296452   100% in    0s     2.42 MB/s  done
    >   Done. Uploaded 598849544 bytes in 463.7 seconds, 1261.15 KB/s.
    >   Stats: Number of files: 4096 (598849544 bytes)
    >   Stats: Number of files transferred: 4096 (598849544 bytes)



# -----------------------------------------------------
# Add another table in the first shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_RRLYRAE

    >   Bucket 's3://GaiaDMp-GDR3_VARI_RRLYRAE/' created
    >   /data/gaia/GDR3/GDR3_VARI_RRLYRAE ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_RRLYRAE/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-115a0635-cd99-4250-94a2-5b1666907202_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_RRLYRAE/.part-00000-115a0635-cd99-4250-94a2-5b1666907202_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    552 of 552   100% in    0s     2.29 KB/s  done
    >   upload: './.part-00001-115a0635-cd99-4250-94a2-5b1666907202_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_RRLYRAE/.part-00001-115a0635-cd99-4250-94a2-5b1666907202_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    532 of 532   100% in    0s  1082.30 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-115a0635-cd99-4250-94a2-5b1666907202_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_RRLYRAE/part-02046-115a0635-cd99-4250-94a2-5b1666907202_02046.c000.snappy.parquet'  [4095 of 4096]
    >    65804 of 65804   100% in    0s   418.23 KB/s  done
    >   upload: './part-02047-115a0635-cd99-4250-94a2-5b1666907202_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_RRLYRAE/part-02047-115a0635-cd99-4250-94a2-5b1666907202_02047.c000.snappy.parquet'  [4096 of 4096]
    >    68351 of 68351   100% in    0s  1334.71 KB/s  done
    >   Done. Uploaded 140335248 bytes in 864.2 seconds, 158.58 KB/s.
    >   Stats: Number of files: 4096 (140335248 bytes)
    >   Stats: Number of files transferred: 4096 (140335248 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_SHORT_TIMESCALE

    >   Bucket 's3://GaiaDMp-GDR3_VARI_SHORT_TIMESCALE/' created
    >   /data/gaia/GDR3/GDR3_VARI_SHORT_TIMESCALE ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_SHORT_TIMESCALE/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-a11a5bb7-8193-4f7e-b565-c61814d7de9f_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_SHORT_TIMESCALE/.part-00000-a11a5bb7-8193-4f7e-b565-c61814d7de9f_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    100 of 100   100% in    0s   525.28 B/s  done
    >   upload: './.part-00001-a11a5bb7-8193-4f7e-b565-c61814d7de9f_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_SHORT_TIMESCALE/.part-00001-a11a5bb7-8193-4f7e-b565-c61814d7de9f_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    92 of 92   100% in    0s  1381.26 B/s  done
    >   ....
    >   ....
    >   upload: './part-02046-a11a5bb7-8193-4f7e-b565-c61814d7de9f_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_SHORT_TIMESCALE/part-02046-a11a5bb7-8193-4f7e-b565-c61814d7de9f_02046.c000.snappy.parquet'  [4095 of 4096]
    >    11386 of 11386   100% in    0s   118.23 KB/s  done
    >   upload: './part-02047-a11a5bb7-8193-4f7e-b565-c61814d7de9f_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_SHORT_TIMESCALE/part-02047-a11a5bb7-8193-4f7e-b565-c61814d7de9f_02047.c000.snappy.parquet'  [4096 of 4096]
    >    10261 of 10261   100% in    0s   105.27 KB/s  done
    >   Done. Uploaded 22426847 bytes in 564.5 seconds, 38.80 KB/s.
    >   Stats: Number of files: 4096 (22426847 bytes)
    >   Stats: Number of files transferred: 4096 (22426847 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_VARI_SUMMARY

    >   Bucket 's3://GaiaDMp-GDR3_VARI_SUMMARY/' created
    >   /data/gaia/GDR3/GDR3_VARI_SUMMARY ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_VARI_SUMMARY/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-6d7f2541-0600-40d0-b343-9109215d16f7_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_SUMMARY/.part-00000-6d7f2541-0600-40d0-b343-9109215d16f7_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    10232 of 10232   100% in    0s   139.09 KB/s  done
    >   upload: './.part-00001-6d7f2541-0600-40d0-b343-9109215d16f7_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_VARI_SUMMARY/.part-00001-6d7f2541-0600-40d0-b343-9109215d16f7_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    10080 of 10080   100% in    0s   255.42 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-6d7f2541-0600-40d0-b343-9109215d16f7_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_SUMMARY/part-02046-6d7f2541-0600-40d0-b343-9109215d16f7_02046.c000.snappy.parquet'  [4095 of 4096]
    >    1325520 of 1325520   100% in    0s    10.28 MB/s  done
    >   upload: './part-02047-6d7f2541-0600-40d0-b343-9109215d16f7_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_VARI_SUMMARY/part-02047-6d7f2541-0600-40d0-b343-9109215d16f7_02047.c000.snappy.parquet'  [4096 of 4096]
    >    1307418 of 1307418   100% in    0s    10.24 MB/s  done
    >   Done. Uploaded 2728711137 bytes in 586.4 seconds, 4.44 MB/s.
    >   Stats: Number of files: 4096 (2728711137 bytes)
    >   Stats: Number of files transferred: 4096 (2728711137 bytes)


# -----------------------------------------------------
# Add another table in the first shell.
#[user@zeppelin]

    uploadtable GDR3_XP_CONTINUOUS_MEAN_SPECTRUM

    >   Bucket 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/' created
    >   /data/gaia/GDR3/GDR3_XP_CONTINUOUS_MEAN_SPECTRUM ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/.part-00000-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    11084380 of 11084380   100% in    0s    15.23 MB/s  done
    >   upload: './.part-00001-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/.part-00001-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    11046132 of 11046132   100% in    0s    22.60 MB/s  done
    >   ....
    >   ....
    >   upload: './part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet'  [part 58 of 91, 15MB] [2336 of 4096]
    >    15728640 of 15728640   100% in    0s    54.96 MB/s  done
    >   ERROR:
    >   Upload of './part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet' part 58 failed. Use
    >     /usr/bin/s3cmd abortmp s3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet 2~LwCr6XS-MBVlxqt70p3S1r2o_tGDqVp
    >   to abort the upload, or
    >     /usr/bin/s3cmd --upload-id 2~LwCr6XS-MBVlxqt70p3S1r2o_tGDqVp put ...
    >   to continue the upload.
    >   ERROR: S3 error: 403 (QuotaExceeded)



# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_XP_SAMPLED_MEAN_SPECTRUM

    >   Bucket 's3://GaiaDMp-GDR3_XP_SAMPLED_MEAN_SPECTRUM/' created
    >   /data/gaia/GDR3/GDR3_XP_SAMPLED_MEAN_SPECTRUM ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_XP_SAMPLED_MEAN_SPECTRUM/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-2b716880-7546-47c5-9427-a6d8d7b67de7_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_XP_SAMPLED_MEAN_SPECTRUM/.part-00000-2b716880-7546-47c5-9427-a6d8d7b67de7_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    362648 of 362648   100% in    0s     2.11 MB/s  done
    >   upload: './.part-00001-2b716880-7546-47c5-9427-a6d8d7b67de7_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_XP_SAMPLED_MEAN_SPECTRUM/.part-00001-2b716880-7546-47c5-9427-a6d8d7b67de7_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    362148 of 362148   100% in    0s     4.24 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-2b716880-7546-47c5-9427-a6d8d7b67de7_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_SAMPLED_MEAN_SPECTRUM/part-02047-2b716880-7546-47c5-9427-a6d8d7b67de7_02047.c000.snappy.parquet'  [part 2 of 3, 15MB] [4096 of 4096]
    >    15728640 of 15728640   100% in    0s    23.01 MB/s  done
    >   upload: './part-02047-2b716880-7546-47c5-9427-a6d8d7b67de7_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_SAMPLED_MEAN_SPECTRUM/part-02047-2b716880-7546-47c5-9427-a6d8d7b67de7_02047.c000.snappy.parquet'  [part 3 of 3, 14MB] [4096 of 4096]
    >    14899263 of 14899263   100% in    0s    23.75 MB/s  done
    >   Done. Uploaded 96190243598 bytes in 6235.7 seconds, 14.71 MB/s.
    >   Stats: Number of files: 4096 (96190243598 bytes)
    >   Stats: Number of files transferred: 4096 (96190243598 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_XP_SUMMARY

    >   Bucket 's3://GaiaDMp-GDR3_XP_SUMMARY/' created
    >   /data/gaia/GDR3/GDR3_XP_SUMMARY ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_XP_SUMMARY/ ...
    >   INFO: Found 4096 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 4096 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './.part-00000-65f50b56-7357-4156-8a0e-90a439681a3e_00000.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_XP_SUMMARY/.part-00000-65f50b56-7357-4156-8a0e-90a439681a3e_00000.c000.snappy.parquet.crc'  [1 of 4096]
    >    32740 of 32740   100% in    0s   290.97 KB/s  done
    >   upload: './.part-00001-65f50b56-7357-4156-8a0e-90a439681a3e_00001.c000.snappy.parquet.crc' -> 's3://GaiaDMp-GDR3_XP_SUMMARY/.part-00001-65f50b56-7357-4156-8a0e-90a439681a3e_00001.c000.snappy.parquet.crc'  [2 of 4096]
    >    32632 of 32632   100% in    0s   391.31 KB/s  done
    >   ....
    >   ....
    >   upload: './part-02046-65f50b56-7357-4156-8a0e-90a439681a3e_02046.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_SUMMARY/part-02046-65f50b56-7357-4156-8a0e-90a439681a3e_02046.c000.snappy.parquet'  [4095 of 4096]
    >    4175485 of 4175485   100% in    0s    16.35 MB/s  done
    >   upload: './part-02047-65f50b56-7357-4156-8a0e-90a439681a3e_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_SUMMARY/part-02047-65f50b56-7357-4156-8a0e-90a439681a3e_02047.c000.snappy.parquet'  [4096 of 4096]
    >    4183032 of 4183032   100% in    0s    16.69 MB/s  done
    >   Done. Uploaded 8637477431 bytes in 964.3 seconds, 8.54 MB/s.
    >   Stats: Number of files: 4096 (8637477431 bytes)
    >   Stats: Number of files transferred: 4096 (8637477431 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_2MASSPSC_BEST_NEIGHBOURS

    >   Bucket 's3://GaiaDMp-GDR3_2MASSPSC_BEST_NEIGHBOURS/' created
    >   /data/gaia/GDR3/GDR3_2MASSPSC_BEST_NEIGHBOURS ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2048 files, this may take some time...
    >   INFO: [1000/2048]
    >   INFO: [2000/2048]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_2MASSPSC_BEST_NEIGHBOURS/ ...
    >   INFO: Found 2048 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2048 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_2MASSPSC_BEST_NEIGHBOURS/part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet'  [part 1 of 2, 15MB] [1 of 2048]
    >    15728640 of 15728640   100% in    0s    27.46 MB/s  done
    >   upload: './part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_2MASSPSC_BEST_NEIGHBOURS/part-00000-b8885964-7d1f-4f8f-88b3-e9a02469bf12_00000.c000.snappy.parquet'  [part 2 of 2, 14MB] [1 of 2048]
    >    15325252 of 15325252   100% in    0s    24.99 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-b8885964-7d1f-4f8f-88b3-e9a02469bf12_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_2MASSPSC_BEST_NEIGHBOURS/part-02047-b8885964-7d1f-4f8f-88b3-e9a02469bf12_02047.c000.snappy.parquet'  [part 1 of 2, 15MB] [2048 of 2048]
    >    15728640 of 15728640   100% in    0s    18.67 MB/s  done
    >   upload: './part-02047-b8885964-7d1f-4f8f-88b3-e9a02469bf12_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_2MASSPSC_BEST_NEIGHBOURS/part-02047-b8885964-7d1f-4f8f-88b3-e9a02469bf12_02047.c000.snappy.parquet'  [part 2 of 2, 14MB] [2048 of 2048]
    >    15447610 of 15447610   100% in    0s    26.09 MB/s  done
    >   Done. Uploaded 63760865732 bytes in 3033.4 seconds, 20.05 MB/s.
    >   Stats: Number of files: 2048 (63760865732 bytes)
    >   Stats: Number of files transferred: 2048 (63760865732 bytes)


# -----------------------------------------------------
# Add another table in the third shell.
#[user@zeppelin]

    uploadtable GDR3_ALLWISE_BEST_NEIGHBOURS

    >   Bucket 's3://GaiaDMp-GDR3_ALLWISE_BEST_NEIGHBOURS/' created
    >   /data/gaia/GDR3/GDR3_ALLWISE_BEST_NEIGHBOURS ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2048 files, this may take some time...
    >   INFO: [1000/2048]
    >   INFO: [2000/2048]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_ALLWISE_BEST_NEIGHBOURS/ ...
    >   INFO: Found 2048 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2048 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './part-00000-ac60c244-841d-4cb2-9832-1ee22020769b_00000.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ALLWISE_BEST_NEIGHBOURS/part-00000-ac60c244-841d-4cb2-9832-1ee22020769b_00000.c000.snappy.parquet'  [part 1 of 6, 15MB] [1 of 2048]
    >    15728640 of 15728640   100% in    0s    16.87 MB/s  done
    >   upload: './part-00000-ac60c244-841d-4cb2-9832-1ee22020769b_00000.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ALLWISE_BEST_NEIGHBOURS/part-00000-ac60c244-841d-4cb2-9832-1ee22020769b_00000.c000.snappy.parquet'  [part 2 of 6, 15MB] [1 of 2048]
    >    15728640 of 15728640   100% in    0s    21.59 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-ac60c244-841d-4cb2-9832-1ee22020769b_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ALLWISE_BEST_NEIGHBOURS/part-02047-ac60c244-841d-4cb2-9832-1ee22020769b_02047.c000.snappy.parquet'  [part 5 of 6, 15MB] [2048 of 2048]
    >    15728640 of 15728640   100% in    0s    23.30 MB/s  done
    >   upload: './part-02047-ac60c244-841d-4cb2-9832-1ee22020769b_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_ALLWISE_BEST_NEIGHBOURS/part-02047-ac60c244-841d-4cb2-9832-1ee22020769b_02047.c000.snappy.parquet'  [part 6 of 6, 13MB] [2048 of 2048]
    >    13941974 of 13941974   100% in    0s    22.98 MB/s  done
    >   Done. Uploaded 189525111830 bytes in 8747.4 seconds, 20.66 MB/s.
    >   Stats: Number of files: 2048 (189525111830 bytes)
    >   Stats: Number of files transferred: 2048 (189525111830 bytes)


# -----------------------------------------------------
# Add another table in the second shell.
#[user@zeppelin]

    uploadtable GDR3_PS1_BEST_NEIGHBOURS

    >   Bucket 's3://GaiaDMp-GDR3_PS1_BEST_NEIGHBOURS/' created
    >   /data/gaia/GDR3/GDR3_PS1_BEST_NEIGHBOURS ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 2048 files, this may take some time...
    >   INFO: [1000/2048]
    >   INFO: [2000/2048]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_PS1_BEST_NEIGHBOURS/ ...
    >   INFO: Found 2048 local files, 0 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 2048 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './part-00000-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_00000.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_PS1_BEST_NEIGHBOURS/part-00000-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_00000.c000.snappy.parquet'  [part 1 of 6, 15MB] [1 of 2048]
    >    15728640 of 15728640   100% in    0s    20.19 MB/s  done
    >   upload: './part-00000-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_00000.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_PS1_BEST_NEIGHBOURS/part-00000-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_00000.c000.snappy.parquet'  [part 2 of 6, 15MB] [1 of 2048]
    >    15728640 of 15728640   100% in    0s    20.75 MB/s  done
    >   ....
    >   ....
    >   upload: './part-02047-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_PS1_BEST_NEIGHBOURS/part-02047-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_02047.c000.snappy.parquet'  [part 5 of 6, 15MB] [2048 of 2048]
    >    15728640 of 15728640   100% in    0s    16.31 MB/s  done
    >   upload: './part-02047-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_02047.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_PS1_BEST_NEIGHBOURS/part-02047-3f6c31d2-590b-4c0a-95d5-7e6588cb24dd_02047.c000.snappy.parquet'  [part 6 of 6, 6MB] [2048 of 2048]
    >    6500790 of 6500790   100% in    0s    19.38 MB/s  done
    >   Done. Uploaded 174243389961 bytes in 8498.3 seconds, 19.55 MB/s.
    >   Stats: Number of files: 2048 (174243389961 bytes)
    >   Stats: Number of files transferred: 2048 (174243389961 bytes)



# -----------------------------------------------------
# -----------------------------------------------------
# Keep track of which tables have been done.

    >   GDR3_2MASSPSC_BEST_NEIGHBOURS           - skip
    >   GDR3_ALERTS_MIXEDIN_SOURCEIDS           - done
    >   GDR3_ALLWISE_BEST_NEIGHBOURS            - skip
    >   GDR3_ASTROPHYSICAL_PARAMETERS           - done
    >   GDR3_ASTROPHYSICAL_PARAMETERS_SUPP      - done
    >   GDR3_EPOCH_PHOTOMETRY                   - done
    >   GDR3_GAIA_SOURCE                        - done
    >   GDR3_GALAXY_CANDIDATES                  - done
    >   GDR3_GALAXY_CATALOGUE_NAME              - done
    >   GDR3_MCMC_SAMPLES_GSP_PHOT              - in progress #5
    >   GDR3_MCMC_SAMPLES_MSC                   - done
    >   GDR3_NSS_ACCELERATION_ASTRO             - done
    >   GDR3_NSS_NON_LINEAR_SPECTRO             - done
    >   GDR3_NSS_TWO_BODY_ORBIT                 - done
    >   GDR3_NSS_VIM_FL                         - done
    >   GDR3_OA_NEURON_INFORMATION              - done
    >   GDR3_OA_NEURON_XP_SPECTRA               - done
    >   GDR3_PS1_BEST_NEIGHBOURS                - skip
    >   GDR3_QSO_CANDIDATES                     - done
    >   GDR3_QSO_CATALOGUE_NAME                 - done
    >   GDR3_RVS_MEAN_SPECTRUM                  - done
    >   GDR3_SCIENCE_ALERTS                     - done
    >   GDR3_SSO_OBSERVATION                    - done
    >   GDR3_SSO_REFLECTANCE_SPECTRUM           - done
    >   GDR3_SSO_SOURCE                         - done
    >   GDR3_TOTAL_GALACTIC_EXTINCTION_MAP      - done
    >   GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT  - done
    >   GDR3_VARI_AGN                           - done
    >   GDR3_VARI_CEPHEID                       - done
    >   GDR3_VARI_CLASSIFIER_CLASS_DEFINITION   - done
    >   GDR3_VARI_CLASSIFIER_DEFINITION         - done
    >   GDR3_VARI_CLASSIFIER_RESULT             - done
    >   GDR3_VARI_COMPACT_COMPANION             - done
    >   GDR3_VARI_ECLIPSING_BINARY              - done
    >   GDR3_VARI_EPOCH_RADIAL_VELOCITY         - done
    >   GDR3_VARI_LONG_PERIOD_VARIABLE          - done
    >   GDR3_VARI_MICROLENSING                  - done
    >   GDR3_VARI_MS_OSCILLATOR                 - done
    >   GDR3_VARI_PLANETARY_TRANSIT             - done
    >   GDR3_VARI_RAD_VEL_STATISTICS            - done
    >   GDR3_VARI_ROTATION_MODULATION           - done
    >   GDR3_VARI_RRLYRAE                       - done
    >   GDR3_VARI_SHORT_TIMESCALE               - done
    >   GDR3_VARI_SUMMARY                       - done
    >   GDR3_XP_CONTINUOUS_MEAN_SPECTRUM        - in progress #1
    >   GDR3_XP_SAMPLED_MEAN_SPECTRUM           - done
    >   GDR3_XP_SUMMARY                         - done


    >   GDR3_2MASSPSC_BEST_NEIGHBOURS           - done
    >   GDR3_ALLWISE_BEST_NEIGHBOURS            - done
    >   GDR3_PS1_BEST_NEIGHBOURS                - done



# -----------------------------------------------------
# Out of space uploading thelast two tables.
#[user@zeppelin]

    #
    # Failed to upload GDR3_XP_CONTINUOUS_MEAN_SPECTRUM.
    # Out of space
    #

    >   ....
    >   ....
    >   upload: './part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet'  [part 58 of 91, 15MB] [2336 of 4096]
    >    15728640 of 15728640   100% in    0s    54.96 MB/s  done
    >   ERROR:
    >   Upload of './part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet' part 58 failed. Use
    >     /usr/bin/s3cmd abortmp s3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet 2~LwCr6XS-MBVlxqt70p3S1r2o_tGDqVp
    >   to abort the upload, or
    >     /usr/bin/s3cmd --upload-id 2~LwCr6XS-MBVlxqt70p3S1r2o_tGDqVp put ...
    >   to continue the upload.
    >   ERROR: S3 error: 403 (QuotaExceeded)


    #
    # Failed to upload GDR3_MCMC_SAMPLES_GSP_PHOT.
    # Out of space
    #

    >   ....
    >   ....
    >   upload: './part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet'  [part 36 of 91, 15MB] [485 of 1604]
    >    15728640 of 15728640   100% in    0s    20.31 MB/s  done
    >   ERROR:
    >   Upload of './part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet' part 36 failed. Use
    >     /usr/bin/s3cmd abortmp s3://GaiaDMp-GDR3_MCMC_SAMPLES_GSP_PHOT/part-00928-2de01f18-0d24-48f5-ad92-5a4a8562e2c8_00928.c000.snappy.parquet 2~UMcYUNLjZKEtVA60dID22VjtqjjJTaV
    >   to abort the upload, or
    >     /usr/bin/s3cmd --upload-id 2~UMcYUNLjZKEtVA60dID22VjtqjjJTaV put ...
    >   to continue the upload.
    >   ERROR: S3 error: 403 (QuotaExceeded)


# -----------------------------------------------------
# See if we can make some space.
#[user@zeppelin]

    s3cmd ls

    >   2022-11-27 03:15  s3://Gaia-GDR3_GAIA_SOURCE
    >   ....
    >   ....
    >   2021-02-28 02:44  s3://gaia-edr3


    s3cmd rb --recursive 's3://Gaia-GDR3_GAIA_SOURCE'

    >   WARNING: Bucket is not empty. Removing all the objects from it first. This may take some time...
    >   delete: 's3://Gaia-GDR3_GAIA_SOURCE/.part-00000-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00000.c000.snappy.parquet.crc'
    >   delete: 's3://Gaia-GDR3_GAIA_SOURCE/.part-00001-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00001.c000.snappy.parquet.crc'
    >   ....
    >   ....
    >   delete: 's3://Gaia-GDR3_GAIA_SOURCE/part-00749-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00749.c000.snappy.parquet'
    >   delete: 's3://Gaia-GDR3_GAIA_SOURCE/part-00750-18ac60bc-42ce-42dd-ab5b-fc0027a56a2c_00750.c000.snappy.parquet'
    >   Bucket 's3://Gaia-GDR3_GAIA_SOURCE/' removed


    s3cmd rb --recursive 's3://gaia-edr3'

    >   WARNING: Bucket is not empty. Removing all the objects from it first. This may take some time...
    >   delete: 's3://gaia-edr3/_SUCCESS'
    >   delete: 's3://gaia-edr3/part-00000-59b9273a-2ef1-4988-8778-e00f67e65264-c000.snappy.parquet'
    >   delete: 's3://gaia-edr3/part-00001-59b9273a-2ef1-4988-8778-e00f67e65264-c000.snappy.parquet'
    >   ....
    >   ....
    >   delete: 's3://gaia-edr3/part-11930-59b9273a-2ef1-4988-8778-e00f67e65264-c000.snappy.parquet'
    >   delete: 's3://gaia-edr3/part-11931-59b9273a-2ef1-4988-8778-e00f67e65264-c000.snappy.parquet'
    >   Bucket 's3://gaia-edr3/' removed


# -----------------------------------------------------
# Try completing GDR3_XP_CONTINUOUS_MEAN_SPECTRUM again.
#[user@zeppelin]

    uploadtable GDR3_XP_CONTINUOUS_MEAN_SPECTRUM

    >   Bucket 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/' created
    >   /data/gaia/GDR3/GDR3_XP_CONTINUOUS_MEAN_SPECTRUM ~
    >   INFO: No cache file found, creating it.
    >   INFO: Compiling list of local files...
    >   INFO: Running stat() and reading/calculating MD5 values on 4096 files, this may take some time...
    >   INFO: [1000/4096]
    >   INFO: [2000/4096]
    >   INFO: [3000/4096]
    >   INFO: [4000/4096]
    >   INFO: Retrieving list of remote files for s3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/ ...
    >   INFO: Found 4096 local files, 2335 remote files
    >   INFO: Verifying attributes...
    >   INFO: Summary: 1761 local files to upload, 0 files to remote copy, 0 remote files to delete
    >   upload: './part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet'  [part 1 of 91, 15MB] [1 of 1761]
    >    15728640 of 15728640   100% in    0s    29.30 MB/s  done
    >   upload: './part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet' -> 's3://GaiaDMp-GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/part-00287-5823b912-106c-4bf2-80b0-e95ac98e8bcf_00287.c000.snappy.parquet'  [part 2 of 91, 15MB] [1 of 1761]
    >    15728640 of 15728640   100% in    0s    27.94 MB/s  done
    >   ....
    >   ....


    TODO
    Get more space allocated (x3)
    Upload an uber collection

    Test example notebooks with data in S3



